<html lang="en">
  <head>
    <title>Uncanny Valley</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <style>
      body {
        color: #fff;
        background: #000;
        padding: 0;
        margin: 0;
        font-family: Avenir, Helvetica, Arial, sans-serif;
        font-size: 13px;
        height: 100%;
      }

      #audioplayer a {
        font-size: 8px;
        color: #a7a7a7;
      }
      #audioplayer a:link {
        text-decoration: none;
        color: #a7a7a7;
      }
      #audioplayer a:hover {
        text-decoration: underline;
      }
      #icons {
        cursor: pointer;
      }
      #credits {
        color: #a7a7a7;
      }
      .credits_item {
        display: none;
        line-height: 1.4;
      }
      #creditsSinjin {
        display: block;
      }

      #info {
        position: absolute;
        top: 0px;
        width: 100%;
        color: #ffffff;
        padding: 5px 0px;
        text-align: center;
        z-index: 1000;
        display: none;
      }

      #buttonsLeft {
        position: absolute;
        bottom: 5em;
        left: 1em;
        border: solid 0px white;
        z-index: 1000;
      }

      #buttonsRight {
        position: absolute;
        bottom: 1em;
        right: 1em;
        border: solid 0px white;
        z-index: 1000;

        display: none;
      }

      .button {
        padding: 0em;
        margin-bottom: 5px;
        background: rgba(0, 0, 0, 0);
        border: solid 0px #000;
        color: black;
        cursor: pointer;
      }

      .button img {
        width: 100px;
      }

      .buttonz:hover {
        background: #888;
      }

      .one {
        opacity: 0;
        -webkit-animation: dot 1.3s infinite;
        -webkit-animation-delay: 0s;
        animation: dot 1.3s infinite;
        animation-delay: 0s;
      }

      .two {
        opacity: 0;
        -webkit-animation: dot 1.3s infinite;
        -webkit-animation-delay: 0.2s;
        animation: dot 1.3s infinite;
        animation-delay: 0.2s;
      }

      .three {
        opacity: 0;
        -webkit-animation: dot 1.3s infinite;
        -webkit-animation-delay: 0.3s;
        animation: dot 1.3s infinite;
        animation-delay: 0.3s;
      }

      @-webkit-keyframes dot {
        0% {
          opacity: 0;
        }
        50% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }

      @keyframes dot {
        0% {
          opacity: 0;
        }
        50% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }

      .playing {
        background: rgba(0, 0, 0, 0);
      }

      #song1button {
        display: none;
      }
      #song2button {
        display: none;
      }
      #song3button {
        display: none;
      }

      #debugOuter {
        position: absolute;
        width: 90%;
        z-index: 2000;
        display: none;
        top: 0;
        color: #0f0;
        margin: 1em;
        font-size: 1.5em;
      }

      #helpOuter {
        position: absolute;
        width: 100%;
        z-index: 2000;
        display: none;
        top: 0;
      }

      #help {
        background: rgba(0, 0, 0, 0.75);
        color: #aaa;
        border: solid 0px #fff;
        margin: 0em auto;
        padding: 0.5em 2em;
        width: 30em;
        line-height: 1.5em;
      }

      .key {
        font-weight: bold;
        color: #fff;
      }

      .shadow {
        box-shadow: 0px 3px 15px rgba(0, 0, 0, 1);
        -moz-box-shadow: 0px 3px 15px rgba(0, 0, 0, 1);
        -webkit-box-shadow: 0px 3px 15px rgba(0, 0, 0, 1);
        -khtml-box-shadow: 0px 3px 15px rgba(0, 0, 0, 1);
      }

      #oldie {
        backgroundz: rgb(200, 100, 0) !important;
        color: #aaa;
      }

      #oldie a {
        color: #fff;
      }

      .loading {
        font-family: Helvetica, Arial, sans-serif;
        font-size: 10px;
        background: #555;
        color: white;
        padding: 0.25em 1em;
        position: absolute;
        right: 0px;
        top: 0px;
        z-index: 200;
      }

      #stats {
        position: absolute;
        top: 5px;
        left: 5px;
      }
      #stats #fps {
        background: transparent !important;
      }
      #stats #fps #fpsText {
        color: #191919 !important;
      }
      #stats #fps #fpsGraph {
        display: none;
      }

      @font-face {
        font-family: "fontello";
        src: url("font/fontello.eot?53853670");
        src: url("font/fontello.eot?53853670#iefix") format("embedded-opentype"),
          url("font/fontello.woff?53853670") format("woff"),
          url("font/fontello.ttf?53853670") format("truetype"),
          url("font/fontello.svg?53853670#fontello") format("svg");
        font-weight: normal;
        font-style: normal;
      }

      #audioplayer {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 61px;
        overflow: hidden;
        border: solid 0px #f00;

        font-family: Avenir, Helvetica, Arial, sans-serif;
      }

      #credits {
        height: 60px;
        color: rgba(255, 255, 255, 0.7);
        list-style: none;
        padding: 0;
        margin: 0;
        margin-left: 25px;
      }
      #credits li {
        display: table-cell;
        vertical-align: middle;
        height: 60px;
        width: 100vw;
        font-size: 8px;
        line-height: 1.7;
      }
      .demo-icon {
        font-family: "fontello";
        font-style: normal;
        font-weight: normal;
        speak: none;

        display: inline-block;
        text-decoration: inherit;
        width: 1em;
        margin-right: 0.2em;
        text-align: center;
        /* opacity: .8; */

        /* For safety - reset parent styles, that can break glyph codes*/
        font-variant: normal;
        text-transform: none;

        /* fix buttons height, for twitter bootstrap */
        line-height: 1em;

        /* Animation center compensation - margins should be symmetric */
        /* remove if not needed */
        margin-left: 0.2em;

        /* You can be more comfortable with increased icons size */
        /* font-size: 120%; */

        /* Font smoothing. That was taken from TWBS */
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;

        /* Uncomment for 3D effect */
        /* text-shadow: 1px 1px 1px rgba(127, 127, 127, 0.3); */
      }

      #volume_full {
        height: 60px;
        width: 60px;
        border: none;
        float: right;
        outline: none;
        position: absolute;
        bottom: 0;
        right: 0;
        z-index: 1;
        text-align: center;
      }

      #volume_mute,
      #volume_half {
        display: none;
        height: 60px;
        width: 60px;
        border: none;
        float: right;
        outline: none;
        position: absolute;
        bottom: 0;
        right: 0;
        z-index: 1;
        text-align: center;
      }
      .icon-volume-up,
      .icon-mute,
      .icon-half {
        color: rgba(255, 255, 255, 0.7);
        font-size: 20px;
        line-height: 60px;
        text-align: center;
        text-decoration: none;
      }

      #play_overlay {
        position: absolute;
        font-size: 5em;
        text-align: center;
        top: 7em;
        z-index: 10000;
        width: 100%;
        display: none;
      }

      .pbutton {
        cursor: pointer;
        background: url(img/START4.png) no-repeat no-repeat;
        /* background-size: 1000px 248px; */
        background-size: 280px 80px;
        /* background-size: auto; */
        color: #fff;

        margin: -0 auto;
        width: 4.3em;
        /* border: solid 1px white;
            */

        /* padding: 0.5em; */
      }

      .pbutton:hover {
        -moz-opacity: 0.7;
        -khtml-opacity: 0.7;
        opacity: 0.7;
        -ms-filter: "progid:DXImageTransform.Microsoft.Alpha" (Opacity=70);
        filter: progid:DXImageTransform.Microsoft.Alpha(opacity=70);
        filter: alpha(opacity=70);
      }
    </style>
  </head>

  <body>
    <div id="loading1" class="loading" style="display: none">
      LOADING <span class="one">.</span><span class="two">.</span
      ><span class="three">.</span>
    </div>
    <div id="loading2" class="loading" style="display: none">
      LOADING <span class="one">.</span><span class="two">.</span
      ><span class="three">.</span>
    </div>
    <div id="loading3" class="loading" style="display: none">
      LOADING <span class="one">.</span><span class="two">.</span
      ><span class="three">.</span>
    </div>

    <div id="play_overlay" style="top: 484px">
      <div class="pbutton" id="play_button">&nbsp;</div>
    </div>

    <div id="info">the uncanny valley</div>

    <div id="debugOuter">
      Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like
      Gecko) Chrome/108.0.0.0 Safari/537.36<br /><br />video: true<br />canvas:
      true<br />shader: true<br />audio: true<br /><br />audioBuffers: false<br />useAudioContextResetHack:
      false<br /><br />Safari: false<br />Firefox: false<br />Explorer: false<br />Chrome:
      true<br /><br />OSX: false<br />useDeferred: true<br />useShadowmaps:
      true<br />useDepthTextures: true<br />useEyeballShadows: true<br /><br />GPU:
      unknown<br /><br />ultra: false
    </div>

    <div id="helpOuter" style="top: 304px">
      <div id="help" class="shadow">
        <h2>Keyboard</h2>

        <ul>
          <li><span class="key">1/2/3:</span> change song</li>
          <li><span class="key">4/5/6:</span> change head</li>
          <li><span class="key">U:</span> toggle ultra visual quality mode</li>
          <li><span class="key">M:</span> change eye behavior mode</li>
          <li><span class="key">F:</span> toggle lights freeze</li>
          <li><span class="key">G:</span> toggle fullscreen</li>
          <li><span class="key">Z:</span> toggle zoom</li>
          <li><span class="key">H:</span> toggle help</li>
        </ul>

        <h2>Mouse</h2>
        <ul>
          <li><span class="key">left click:</span> change eye</li>
        </ul>
      </div>
    </div>

    <div id="buttonsLeft">
      <div class="button" id="song1button" style="display: none">
        <img src="uncannyvalley/img/thumbnail-head3b.png" />
      </div>
      <div class="button" id="song2button" style="display: block">
        <img src="uncannyvalley/img/thumbnail-head2b.png" />
      </div>
      <div class="button" id="song3button" style="display: block">
        <img src="uncannyvalley/img/thumbnail-head1b.png" />
      </div>
    </div>

    <div id="buttonsRight">
      <div class="button" id="fullscreenButton">Fullscreen</div>
    </div>

    <!--
    <script src="./xg.min.uv.js"></script>
    <script src="./DetectorUncannyValley.js"></script>
    <script src="./PlayerUncannyValley.js"></script>
    <script src="./stats.min.js"></script>
    -->
    <script src="./uv.662.js"></script>

    <!--
    <audio id="song1">
        <source src="./assets/1-sinjin-uncanny-valley-draft-2.m4a" type="audio/mp4">
        <source src="./assets/1-sinjin-uncanny-valley-draft-2.ogg" type="audio/ogg">
    </audio>
    <audio id="song2">
        <source src="./assets/134bpm-uncannyvalley-sinjin-zora-martynbootyspoon.m4a" type="audio/mp4">
        <source src="./assets/134bpm-uncannyvalley-sinjin-zora-martynbootyspoon.ogg" type="audio/ogg">
    </audio>
    <audio id="song3">
        <source src="./assets/LUZ (altered qualia) 2.m4a" type="audio/mp4">
        <source src="./assets/LUZ (altered qualia) 2.ogg" type="audio/ogg">
    </audio>
    -->

    <div
      id="audioplayer"
      style="user-select: none; display: block"
      unselectable="on"
      onselectstart="return false;"
      onmousedown="return false;"
    >
      <ul id="credits">
        <li>
          <b>UNCANNY VALLEY</b> |
          <a href="https://alteredqualia.com" target="_blank">ALTEREDQUALIA</a
          ><br />
          <i>
            TYPE [H] FOR HELP &amp; OPTIONS<i>
              <br />
              <span class="credits_item" id="creditsAll"
                >Sound Design: Sinjin Hawke, Zora Jones &amp; Martyn
                Bootyspoon</span
              >
              <span
                class="credits_item"
                id="creditsSinjin"
                style="display: block"
                >Sound Design: Sinjin Hawke</span
              >
              <span class="credits_item" id="creditsZora"
                >Sound Design: Zora Jones</span
              >
              <span class="credits_item" id="creditsMartyn"
                >Sound Design: Martyn Bootyspoon</span
              >
            </i></i
          >
        </li>
        <i><i> </i></i>
      </ul>
      <i
        ><i>
          <div id="icons">
            <div id="volume_full">
              <i class="demo-icon icon-volume-up"></i>
            </div>
            <div id="volume_half">
              <i class="demo-icon icon-half"></i>
            </div>
            <div id="volume_mute">
              <i class="demo-icon icon-mute"></i>
            </div>
          </div>
        </i></i
      >
    </div>
    <i
      ><i>
        <script>
          var isAndroid = !!navigator.userAgent.match(/Android/i);

          var isIpadOS =
            navigator.userAgent.match(/Macintosh/i) &&
            navigator.maxTouchPoints !== undefined &&
            navigator.maxTouchPoints > 1;

          var isIOS = !!(
            navigator.userAgent.match(/iPhone/i) ||
            navigator.userAgent.match(/iPad/i) ||
            navigator.userAgent.match(/iPod/i)
          );

          var isMobile = isAndroid || isIOS || isIpadOS;

          if (!Detector.webgl) {
            var loadingElement1 = document.getElementById("loading1");
            var loadingElement2 = document.getElementById("loading2");
            var loadingElement3 = document.getElementById("loading3");

            loadingElement1.style.display = "none";
            loadingElement2.style.display = "none";
            loadingElement3.style.display = "none";

            Detector.addGetWebGLMessage();
          } else {
            var playButtonElement = document.getElementById("play_button");
            var playButtonOverlayElement =
              document.getElementById("play_overlay");
            var playButtonVisible = false;

            // --------------------------------------------------------------

            var useDeferred = Detector.deferredCapable;

            var useMRT = true;

            var useShadowmaps = true;
            var useDepthTextures = true;
            var useEyeballShadows = true;

            var useVideoTextures = true;
            var useCanvasTextures = true;
            var useShaderTextures = true;

            var useAudioAnalysis = true;
            var useAudioBuffers = false;
            var useAudioContextResetHack = false;

            // platform-specific compatibility fixes
            // (not supported features and things that are supposed to work but are broken anyways)

            var isChrome =
              navigator.userAgent.toLowerCase().indexOf("chrome") >= 0;
            var isSafari =
              navigator.userAgent.toLowerCase().indexOf("safari") >= 0 &&
              !isChrome;
            var isFirefox =
              navigator.userAgent.toLowerCase().indexOf("firefox") >= 0;
            var isExplorer =
              navigator.userAgent.toLowerCase().indexOf("trident") >= 0;
            var isOSX =
              navigator.platform.toLowerCase().indexOf("mac") >= 0 && !isIpadOS;

            // Firefox on OSX fails with multiple-render-targets

            if (isOSX && isFirefox) useMRT = false;

            // Safari on OSX fails video textures and 2d canvas textures
            // shader textures cause erratic freezes
            // depth texture shadowmaps are very artefacty
            // eyeball self-shadows completely hide specular highlight

            if (isOSX && isSafari) {
              useVideoTextures = false;
              useDepthTextures = false;
              useEyeballShadows = false;

              useAudioBuffers = false;
            }

            // iOS Web Audio API audio analyser doesn't work with <audio> elements
            // also latency with <audio> elements without analysis is terrible
            // audio context needs workaround to deal with buggy sample rate with headphones / bluetooth speakers

            if (isIOS || isIpadOS) {
              useAudioBuffers = false;
              useAudioContextResetHack = true;
            }

            // Explorer on Windows doesn't have implemented
            // video textures and audio API

            if (isExplorer) {
              useVideoTextures = false;
              useCanvasTextures = false;
            }

            useCanvasTextures = useCanvasTextures && useAudioAnalysis;

            // --------------------------------------------------------------

            var debugStr = navigator.userAgent;
            debugStr +=
              "<br/><br/>video: " +
              useVideoTextures +
              "<br/>canvas: " +
              useCanvasTextures +
              "<br/>shader: " +
              useShaderTextures +
              "<br/>audio: " +
              useAudioAnalysis;
            debugStr += "<br/><br/>audioBuffers: " + useAudioBuffers;
            debugStr +=
              "<br/>useAudioContextResetHack: " + useAudioContextResetHack;
            debugStr +=
              "<br/><br/>Safari: " +
              isSafari +
              "<br/>Firefox: " +
              isFirefox +
              "<br/>Explorer: " +
              isExplorer +
              "<br/>Chrome: " +
              isChrome;
            debugStr += "<br/><br/>OSX: " + isOSX;
            debugStr += "<br/>useDeferred: " + useDeferred;
            debugStr += "<br/>useShadowmaps: " + useShadowmaps;
            debugStr += "<br/>useDepthTextures: " + useDepthTextures;
            debugStr += "<br/>useEyeballShadows: " + useEyeballShadows;

            var elDebug = document.getElementById("debugOuter");
            elDebug.innerHTML = debugStr;

            var debugVisible = true;

            // --------------------------------------------------------------

            var currentSong = "song1"; // song1 song2 song3
            var currentHead = "head3"; // head1 head2 head3

            // --------------------------------------------------------------

            var BRIGHTNESS = 1.05;

            var MARGIN = 61;
            var SCALE = 0.7 / window.devicePixelRatio;
            var SCALE_FORWARD = 1.0;
            //var SCALE_FORWARD = window.devicePixelRatio;

            var ULTRA_THRESHOLD = 4000;

            var SIDE_MARGIN = 0;
            var IMG_WIDTH = 1520;
            if (window.innerWidth > IMG_WIDTH)
              SIDE_MARGIN = (window.innerWidth - IMG_WIDTH) * 0.5;

            var WIDTH = window.innerWidth - 2 * SIDE_MARGIN;
            var HEIGHT = window.innerHeight - 1 * MARGIN;

            var RESIZE_HACK = 0;

            var statsEnabled = true;
            var isUltra = false;

            var eyeRigEnabled = true;

            var initEyeBehaviorType = 0; // 0, 1
            var initEyeBehaviorCountDown = 10;

            var effectColorCorrection;
            var effectLens;

            var videos = [];
            var textureVideos = [];
            var currentVideoBase = 0;
            var currentVideoOverlay = 0;

            //

            var useKeyLight = true;
            var useBackLight = true;

            var freezeLights = false;
            var freezeIndex = 3;

            //

            var cameraConfig = [
              [5, 0, 560, 3500],
              [11, 0, 320, 1800],
              [13, 0, 350, 2000],
              [15, 0, 380, 2300],
              [13, 0, 350, 2000],
              [11, 0, 320, 1800],
            ];

            var cameraIndex = 0;

            //

            var audioCtx;

            var analyser;
            var freqByteData;
            var playingAudio = false;

            var beatsShifter;

            var overlayBase = 0;

            //

            var diffuseComposer;
            var diffuseUniforms;

            //

            var backFull, backA, backB;

            //

            var leftPlane = new XG.Plane();
            var rightPlane = new XG.Plane();

            var leftPupilPosition = new XG.Vector3();
            var rightPupilPosition = new XG.Vector3();

            var leftPupilUpPosition = new XG.Vector3();
            var rightPupilUpPosition = new XG.Vector3();

            var leftPupilSidePosition = new XG.Vector3();
            var rightPupilSidePosition = new XG.Vector3();

            var leftLensPosition = new XG.Vector3();
            var rightLensPosition = new XG.Vector3();

            var leftHitPosition = new XG.Vector3();
            var rightHitPosition = new XG.Vector3();

            var keyLightPosition = new XG.Vector3();

            var originToPoint = new XG.Vector3();
            var unitAxisVector = new XG.Vector3();

            //

            var elPlayer = document.getElementById("audioplayer");
            var elHelp = document.getElementById("helpOuter");
            var helpVisible = false;

            // --------------------------------------------------------------

            initAudioContext();
            if (!useAudioContextResetHack) wireAudioGraph();

            // --------------------------------------------------------------

            var configSong = {
              song1: {
                id: "song1",
                src: "https://fractalfantasy.net/uncannyvalley/uncannyvalley/sounds/1-sinjin-uncanny-valley-draft-2.m4a",

                audioElement: null,
                buttonElement: null,
                creditsElement: null,

                audioBuffer: null,
                audioBufferSource: null,
                audioBufferGain: null,

                audioBufferStartTime: 0.0,
                audioBufferOffsetTime: 0.0,
                audioBufferPlaying: false,

                beats: [
                  0.0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1.0, 1.125,
                  1.25, 1.375, 1.5, 1.625, 1.75, 1.875, 2.0, 2.125, 2.25, 2.375,
                  2.5, 2.625, 2.75, 2.875, 3.0, 3.125, 3.25, 3.375, 3.5, 3.625,
                  3.75, 3.875, 4.0, 4.125, 4.25, 4.375, 4.5, 4.625, 4.75, 4.875,
                  5.0, 5.125, 5.25, 5.375, 5.5, 5.625, 5.75, 5.875, 6.0, 6.125,
                  6.25, 6.375, 6.5, 6.625, 6.75, 6.875, 7.0, 7.125, 7.25, 7.375,
                  7.5, 7.625, 7.75, 7.875, 8.0, 8.125, 8.25, 8.375, 8.5, 8.625,
                  8.75, 8.875, 9.0, 9.125, 9.25, 9.375, 9.5, 9.625, 9.75, 9.875,
                  10.0, 10.125, 10.25, 10.375, 10.5, 10.625, 10.75, 10.875,
                  11.0, 11.125, 11.25, 11.375, 11.5, 11.625, 11.75, 11.875,
                  12.0, 12.125, 12.25, 12.375, 12.5, 12.625, 12.75, 12.875,
                  13.0, 13.125, 13.25, 13.375, 13.5, 13.625, 13.75, 13.875,
                  14.0, 14.125, 14.25, 14.375, 14.5, 14.625, 14.75, 14.875,
                  15.0, 15.125, 15.25, 15.375, 15.5, 15.625, 15.75, 15.875,
                  16.0, 16.0625, 16.125, 16.1875, 16.25, 16.3125, 16.375,
                  16.4375, 16.5, 16.5625, 16.625, 16.6875, 16.75, 16.8125,
                  16.875, 16.9375, 17.0, 17.0625, 17.125, 17.1875, 17.25,
                  17.3125, 17.375, 17.4375, 17.5, 17.5, 17.5625, 17.625,
                  17.6875, 17.75, 17.8125, 17.875, 17.9375, 18.0, 18.0625,
                  18.125, 18.1875, 18.25, 18.3125, 18.375, 18.4375, 18.5,
                  18.5625, 18.625, 18.6875, 18.75, 18.8125, 18.875, 18.9375,
                  19.0, 19.0625, 19.125, 19.1875, 19.25, 19.3125, 19.375,
                  19.4375, 19.5, 19.5625, 19.625, 19.6875, 19.75, 19.8125,
                  19.875, 19.9375, 20.0, 20.0, 20.125, 20.25, 20.375, 20.5,
                  20.625, 20.75, 20.875, 21.0, 21.125, 21.25, 21.375, 21.5,
                  21.625, 21.75, 21.875, 22.0, 22.125, 22.25, 22.375, 22.5,
                  22.625, 22.75, 22.875, 23.0, 23.125, 23.25, 23.375, 23.5,
                  23.625, 23.75, 23.875, 24.0, 24.125, 24.25, 24.375, 24.5,
                  24.625, 24.75, 24.875, 25.0, 25.125, 25.25, 25.375, 25.5,
                  25.625, 25.75, 25.875, 26.0, 26.125, 26.25, 26.375, 26.5,
                  26.625, 26.75, 26.875, 27.0, 27.125, 27.25, 27.375, 27.5,
                  27.625, 27.75, 27.875, 28.0, 28.125, 28.25, 28.375, 28.5,
                  28.625, 28.75, 28.875, 29.0, 29.125, 29.25, 29.375, 29.5,
                  29.625, 29.75, 29.875, 30.0, 30.125, 30.25, 30.375, 30.5,
                  30.625, 30.75, 30.875, 31.0, 31.125, 31.25, 31.375, 31.5,
                  31.625, 31.75, 31.875, 32.0, 32.125, 32.25, 32.375, 32.5,
                  32.625, 32.75, 32.875, 33.0, 33.125, 33.25, 33.375, 33.5,
                  33.625, 33.75, 33.875, 34.0, 34.125, 34.25, 34.375, 34.5,
                  34.625, 34.75, 34.875, 35.0, 35.125, 35.25, 35.375, 35.5,
                  35.625, 35.75, 35.875, 36.0, 36.0625, 36.125, 36.1875, 36.25,
                  36.3125, 36.375, 36.4375, 36.5, 36.5625, 36.625, 36.6875,
                  36.75, 36.8125, 36.875, 36.9375, 37.0, 37.0625, 37.125,
                  37.1875, 37.25, 37.3125, 37.375, 37.4375, 37.5, 37.5, 37.5625,
                  37.625, 37.6875, 37.75, 37.8125, 37.875, 37.9375, 38.0,
                  38.0625, 38.125, 38.1875, 38.25, 38.3125, 38.375, 38.4375,
                  38.5, 38.5625, 38.625, 38.6875, 38.75, 38.8125, 38.875,
                  38.9375, 39.0, 39.0625, 39.125, 39.1875, 39.25, 39.3125,
                  39.375, 39.4375, 39.5, 39.5625, 39.625, 39.6875, 39.75,
                  39.8125, 39.875, 39.9375, 40.0, 40.0, 40.125, 40.25, 40.375,
                  40.5, 40.625, 40.75, 40.875, 41.0, 41.125, 41.25, 41.375,
                  41.5, 41.625, 41.75, 41.875, 42.0, 42.125, 42.25, 42.375,
                  42.5, 42.625, 42.75, 42.875, 43.0, 43.125, 43.25, 43.375,
                  43.5, 43.625, 43.75, 43.875, 44.0, 44.125, 44.25, 44.375,
                  44.5, 44.625, 44.75, 44.875, 45.0, 45.125, 45.25, 45.375,
                  45.5, 45.625, 45.75, 45.875, 46.0, 46.125, 46.25, 46.375,
                  46.5, 46.625, 46.75, 46.875, 47.0, 47.125, 47.25, 47.375,
                  47.5, 47.625, 47.75, 47.875, 48.0, 48.125, 48.25, 48.375,
                  48.5, 48.625, 48.75, 48.875, 49.0, 49.125, 49.25, 49.375,
                  49.5, 49.625, 49.75, 49.875, 50.0, 50.125, 50.25, 50.375,
                  50.5, 50.625, 50.75, 50.875, 51.0, 51.125, 51.25, 51.375,
                  51.5, 51.625, 51.75, 51.875, 52.0, 52.125, 52.25, 52.375,
                  52.5, 52.625, 52.75, 52.875, 53.0, 53.125, 53.25, 53.375,
                  53.5, 53.625, 53.75, 53.875, 54.0, 54.125, 54.25, 54.375,
                  54.5, 54.625, 54.75, 54.875, 55.0, 55.125, 55.25, 55.375,
                  55.5, 55.625, 55.75, 55.875, 56.0, 56.0625, 56.125, 56.1875,
                  56.25, 56.3125, 56.375, 56.4375, 56.5, 56.5625, 56.625,
                  56.6875, 56.75, 56.8125, 56.875, 56.9375, 57.0, 57.0625,
                  57.125, 57.1875, 57.25, 57.3125, 57.375, 57.4375, 57.5, 57.5,
                  57.5625, 57.625, 57.6875, 57.75, 57.8125, 57.875, 57.9375,
                  58.0, 58.0625, 58.125, 58.1875, 58.25, 58.3125, 58.375,
                  58.4375, 58.5, 58.5625, 58.625, 58.6875, 58.75, 58.8125,
                  58.875, 58.9375, 59.0, 59.0625, 59.125, 59.1875, 59.25,
                  59.3125, 59.375, 59.4375, 59.5, 59.5625, 59.625, 59.6875,
                  59.75, 59.8125, 59.875, 59.9375, 60.0, 60.0, 60.125, 60.25,
                  60.375, 60.5, 60.625, 60.75, 60.875, 61.0, 61.125, 61.25,
                  61.375, 61.5, 61.625, 61.75, 61.875, 62.0, 62.125, 62.25,
                  62.375, 62.5, 62.625, 62.75, 62.875, 63.0, 63.125, 63.25,
                  63.375, 63.5, 63.625, 63.75, 63.875, 64.0, 64.125, 64.25,
                  64.375, 64.5, 64.625, 64.75, 64.875, 65.0, 65.125, 65.25,
                  65.375, 65.5, 65.625, 65.75, 65.875, 66.0, 66.125, 66.25,
                  66.375, 66.5, 66.625, 66.75, 66.875, 67.0, 67.125, 67.25,
                  67.375, 67.5, 67.625, 67.75, 67.875, 68.0, 68.125, 68.25,
                  68.375, 68.5, 68.625, 68.75, 68.875, 69.0, 69.125, 69.25,
                  69.375, 69.5, 69.625, 69.75, 69.875, 70.0, 70.125, 70.25,
                  70.375, 70.5, 70.625, 70.75, 70.875, 71.0, 71.125, 71.25,
                  71.375, 71.5, 71.625, 71.75, 71.875, 72.0, 72.125, 72.25,
                  72.375, 72.5, 72.625, 72.75, 72.875, 73.0, 73.125, 73.25,
                  73.375, 73.5, 73.625, 73.75, 73.875, 74.0, 74.125, 74.25,
                  74.375, 74.5, 74.625, 74.75, 74.875, 75.0, 75.125, 75.25,
                  75.375, 75.5, 75.625, 75.75, 75.875, 76.0, 76.0625, 76.125,
                  76.1875, 76.25, 76.3125, 76.375, 76.4375, 76.5, 76.5625,
                  76.625, 76.6875, 76.75, 76.8125, 76.875, 76.9375, 77.0,
                  77.0625, 77.125, 77.1875, 77.25, 77.3125, 77.375, 77.4375,
                  77.5, 77.5, 77.5625, 77.625, 77.6875, 77.75, 77.8125, 77.875,
                  77.9375, 78.0, 78.0625, 78.125, 78.1875, 78.25, 78.3125,
                  78.375, 78.4375, 78.5, 78.5625, 78.625, 78.6875, 78.75,
                  78.8125, 78.875, 78.9375, 79.0, 79.0625, 79.125, 79.1875,
                  79.25, 79.3125, 79.375, 79.4375, 79.5, 79.5625, 79.625,
                  79.6875, 79.75, 79.8125, 79.875, 79.9375, 80.0, 80.0, 80.125,
                  80.25, 80.375, 80.5, 80.625, 80.75, 80.875, 81.0, 81.125,
                  81.25, 81.375, 81.5, 81.625, 81.75, 81.875, 82.0, 82.125,
                  82.25, 82.375, 82.5, 82.625, 82.75, 82.875, 83.0, 83.125,
                  83.25, 83.375, 83.5, 83.625, 83.75, 83.875, 84.0, 84.125,
                  84.25, 84.375, 84.5, 84.625, 84.75, 84.875, 85.0, 85.125,
                  85.25, 85.375, 85.5, 85.625, 85.75, 85.875, 86.0, 86.125,
                  86.25, 86.375, 86.5, 86.625, 86.75, 86.875, 87.0, 87.125,
                  87.25, 87.375, 87.5, 87.625, 87.75, 87.875, 88.0, 88.125,
                  88.25, 88.375, 88.5, 88.625, 88.75, 88.875, 89.0, 89.125,
                  89.25, 89.375, 89.5, 89.625, 89.75, 89.875, 90.0, 90.125,
                  90.25, 90.375, 90.5, 90.625, 90.75, 90.875, 91.0, 91.125,
                  91.25, 91.375, 91.5, 91.625, 91.75, 91.875, 92.0, 92.125,
                  92.25, 92.375, 92.5, 92.625, 92.75, 92.875, 93.0, 93.125,
                  93.25, 93.375, 93.5, 93.625, 93.75, 93.875, 94.0, 94.125,
                  94.25, 94.375, 94.5, 94.625, 94.75, 94.875, 95.0, 95.125,
                  95.25, 95.375, 95.5, 95.625, 95.75, 95.875, 96.0, 96.0625,
                  96.125, 96.1875, 96.25, 96.3125, 96.375, 96.4375, 96.5,
                  96.5625, 96.625, 96.6875, 96.75, 96.8125, 96.875, 96.9375,
                  97.0, 97.0625, 97.125, 97.1875, 97.25, 97.3125, 97.375,
                  97.4375, 97.5, 97.5, 97.5625, 97.625, 97.6875, 97.75, 97.8125,
                  97.875, 97.9375, 98.0, 98.0625, 98.125, 98.1875, 98.25,
                  98.3125, 98.375, 98.4375, 98.5, 98.5625, 98.625, 98.6875,
                  98.75, 98.8125, 98.875, 98.9375, 99.0, 99.0625, 99.125,
                  99.1875, 99.25, 99.3125, 99.375, 99.4375, 99.5, 99.5625,
                  99.625, 99.6875, 99.75, 99.8125, 99.875, 99.9375, 100.0,
                  100.0, 100.125, 100.25, 100.375, 100.5, 100.625, 100.75,
                  100.875, 101.0, 101.125, 101.25, 101.375, 101.5, 101.625,
                  101.75, 101.875, 102.0, 102.125, 102.25, 102.375, 102.5,
                  102.625, 102.75, 102.875, 103.0, 103.125, 103.25, 103.375,
                  103.5, 103.625, 103.75, 103.875, 104.0, 104.125, 104.25,
                  104.375, 104.5, 104.625, 104.75, 104.875, 105.0, 105.125,
                  105.25, 105.375, 105.5, 105.625, 105.75, 105.875, 106.0,
                  106.125, 106.25, 106.375, 106.5, 106.625, 106.75, 106.875,
                  107.0, 107.125, 107.25, 107.375, 107.5, 107.625, 107.75,
                  107.875, 108.0, 108.125, 108.25, 108.375, 108.5, 108.625,
                  108.75, 108.875, 109.0, 109.125, 109.25, 109.375, 109.5,
                  109.625, 109.75, 109.875, 110.0, 110.125, 110.25, 110.375,
                  110.5, 110.625, 110.75, 110.875, 111.0, 111.125, 111.25,
                  111.375, 111.5, 111.625, 111.75, 111.875, 112.0, 112.125,
                  112.25, 112.375, 112.5, 112.625, 112.75, 112.875, 113.0,
                  113.125, 113.25, 113.375, 113.5, 113.625, 113.75, 113.875,
                  114.0, 114.125, 114.25, 114.375, 114.5, 114.625, 114.75,
                  114.875, 115.0, 115.125, 115.25, 115.375, 115.5, 115.625,
                  115.75, 115.875, 116.0, 116.0625, 116.125, 116.1875, 116.25,
                  116.3125, 116.375, 116.4375, 116.5, 116.5625, 116.625,
                  116.6875, 116.75, 116.8125, 116.875, 116.9375, 117.0,
                  117.0625, 117.125, 117.1875, 117.25, 117.3125, 117.375,
                  117.4375, 117.5, 117.5, 117.5625, 117.625, 117.6875, 117.75,
                  117.8125, 117.875, 117.9375, 118.0, 118.0625, 118.125,
                  118.1875, 118.25, 118.3125, 118.375, 118.4375, 118.5,
                  118.5625, 118.625, 118.6875, 118.75, 118.8125, 118.875,
                  118.9375, 119.0, 119.0625, 119.125, 119.1875, 119.25,
                  119.3125, 119.375, 119.4375, 119.5, 119.5625, 119.625,
                  119.6875, 119.75, 119.8125, 119.875, 119.9375, 120.0, 120.0,
                  120.125, 120.25, 120.375, 120.5, 120.625, 120.75, 120.875,
                  121.0, 121.125, 121.25, 121.375, 121.5, 121.625, 121.75,
                  121.875, 122.0, 122.125, 122.25, 122.375, 122.5, 122.625,
                  122.75, 122.875, 123.0, 123.125, 123.25, 123.375, 123.5,
                  123.625, 123.75, 123.875, 124.0, 124.125, 124.25, 124.375,
                  124.5, 124.625, 124.75, 124.875, 125.0, 125.125, 125.25,
                  125.375, 125.5, 125.625, 125.75, 125.875, 126.0, 126.125,
                  126.25, 126.375, 126.5, 126.625, 126.75, 126.875, 127.0,
                  127.125, 127.25, 127.375, 127.5, 127.625, 127.75, 127.875,
                  128.0, 128.125, 128.25, 128.375, 128.5, 128.625, 128.75,
                  128.875, 129.0, 129.125, 129.25, 129.375, 129.5, 129.625,
                  129.75, 129.875, 130.0, 130.125, 130.25, 130.375, 130.5,
                  130.625, 130.75, 130.875, 131.0, 131.125, 131.25, 131.375,
                  131.5, 131.625, 131.75, 131.875, 132.0, 132.125, 132.25,
                  132.375, 132.5, 132.625, 132.75, 132.875, 133.0, 133.125,
                  133.25, 133.375, 133.5, 133.625, 133.75, 133.875, 134.0,
                  134.125, 134.25, 134.375, 134.5, 134.625, 134.75, 134.875,
                  135.0, 135.125, 135.25, 135.375, 135.5, 135.625, 135.75,
                  135.875, 136.0, 136.0625, 136.125, 136.1875, 136.25, 136.3125,
                  136.375, 136.4375, 136.5, 136.5625, 136.625, 136.6875, 136.75,
                  136.8125, 136.875, 136.9375, 137.0, 137.0625, 137.125,
                  137.1875, 137.25, 137.3125, 137.375, 137.4375, 137.5, 137.5,
                  137.5625, 137.625, 137.6875, 137.75, 137.8125, 137.875,
                  137.9375, 138.0, 138.0625, 138.125, 138.1875, 138.25,
                  138.3125, 138.375, 138.4375, 138.5, 138.5625, 138.625,
                  138.6875, 138.75, 138.8125, 138.875, 138.9375, 139.0,
                  139.0625, 139.125, 139.1875, 139.25, 139.3125, 139.375,
                  139.4375, 139.5, 139.5625, 139.625, 139.6875, 139.75,
                  139.8125, 139.875, 139.9375, 140.0, 140.0, 140.125, 140.25,
                  140.375, 140.5, 140.625, 140.75, 140.875, 141.0, 141.125,
                  141.25, 141.375, 141.5, 141.625, 141.75, 141.875, 142.0,
                  142.125, 142.25, 142.375, 142.5, 142.625, 142.75, 142.875,
                  143.0, 143.125, 143.25, 143.375, 143.5, 143.625, 143.75,
                  143.875, 144.0, 144.125, 144.25, 144.375, 144.5, 144.625,
                  144.75, 144.875, 145.0, 145.125, 145.25, 145.375, 145.5,
                  145.625, 145.75, 145.875, 146.0, 146.125, 146.25, 146.375,
                  146.5, 146.625, 146.75, 146.875, 147.0, 147.125, 147.25,
                  147.375, 147.5, 147.625, 147.75, 147.875, 148.0, 148.125,
                  148.25, 148.375, 148.5, 148.625, 148.75, 148.875, 149.0,
                  149.125, 149.25, 149.375, 149.5, 149.625, 149.75, 149.875,
                  150.0, 150.125, 150.25, 150.375, 150.5, 150.625, 150.75,
                  150.875, 151.0, 151.125, 151.25, 151.375, 151.5, 151.625,
                  151.75, 151.875, 152.0, 152.125, 152.25, 152.375, 152.5,
                  152.625, 152.75, 152.875, 153.0, 153.125, 153.25, 153.375,
                  153.5, 153.625, 153.75, 153.875, 154.0, 154.125, 154.25,
                  154.375, 154.5, 154.625, 154.75, 154.875, 155.0, 155.125,
                  155.25, 155.375, 155.5, 155.625, 155.75, 155.875, 156.0,
                  156.0625, 156.125, 156.1875, 156.25, 156.3125, 156.375,
                  156.4375, 156.5, 156.5625, 156.625, 156.6875, 156.75,
                  156.8125, 156.875, 156.9375, 157.0, 157.0625, 157.125,
                  157.1875, 157.25, 157.3125, 157.375, 157.4375, 157.5, 157.5,
                  157.5625, 157.625, 157.6875, 157.75, 157.8125, 157.875,
                  157.9375, 158.0, 158.0625, 158.125, 158.1875, 158.25,
                  158.3125, 158.375, 158.4375, 158.5, 158.5625, 158.625,
                  158.6875, 158.75, 158.8125, 158.875, 158.9375, 159.0,
                  159.0625, 159.125, 159.1875, 159.25, 159.3125, 159.375,
                  159.4375, 159.5, 159.5625, 159.625, 159.6875, 159.75,
                  159.8125, 159.875, 159.9375, 160.0, 160.0, 160.125, 160.25,
                  160.375, 160.5, 160.625, 160.75, 160.875, 161.0, 161.125,
                  161.25, 161.375, 161.5, 161.625, 161.75, 161.875, 162.0,
                  162.125, 162.25, 162.375, 162.5, 162.625, 162.75, 162.875,
                  163.0, 163.125, 163.25, 163.375, 163.5, 163.625, 163.75,
                  163.875, 164.0, 164.125, 164.25, 164.375, 164.5, 164.625,
                  164.75, 164.875, 165.0, 165.125, 165.25, 165.375, 165.5,
                  165.625, 165.75, 165.875, 166.0, 166.125, 166.25, 166.375,
                  166.5, 166.625, 166.75, 166.875, 167.0, 167.125, 167.25,
                  167.375, 167.5, 167.625, 167.75, 167.875, 168.0, 168.125,
                  168.25, 168.375, 168.5, 168.625, 168.75, 168.875, 169.0,
                  169.125, 169.25, 169.375, 169.5, 169.625, 169.75, 169.875,
                  170.0, 170.125, 170.25, 170.375, 170.5, 170.625, 170.75,
                  170.875, 171.0, 171.125, 171.25, 171.375, 171.5, 171.625,
                  171.75, 171.875, 172.0, 172.125, 172.25, 172.375, 172.5,
                  172.625, 172.75, 172.875, 173.0, 173.125, 173.25, 173.375,
                  173.5, 173.625, 173.75, 173.875, 174.0, 174.125, 174.25,
                  174.375, 174.5, 174.625, 174.75, 174.875, 175.0, 175.125,
                  175.25, 175.375, 175.5, 175.625, 175.75, 175.875,
                ],
                bpm: 115,
                volumeBase: 1.0,
                volumeScale: 1.0,
                beatIndex: 0,

                head: "head3",
                credits: "creditsSinjin",
              },

              song2: {
                id: "song2",
                src: "https://fractalfantasy.net/uncannyvalley/uncannyvalley/sounds/134bpm-uncannyvalley-sinjin-zora-martynbootyspoon.m4a",

                audioElement: null,
                buttonElement: null,
                creditsElement: null,

                audioBuffer: null,
                audioBufferSource: null,
                audioBufferGain: null,

                audioBufferStartTime: 0.0,
                audioBufferOffsetTime: 0.0,
                audioBufferPlaying: false,

                beats: [
                  0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5,
                  6.0, 6.5, 7.0, 7.5, 8.0, 9.0, 9.25, 11.0, 11.25, 11.5, 13.0,
                  13.25, 15.0, 15.25, 15.5, 17.0, 17.25, 19.0, 19.25, 19.5,
                  21.0, 21.25, 23.5, 25.0, 25.25, 27.0, 27.25, 27.5, 29.0,
                  29.25, 31.0, 31.25, 31.5, 33.0, 33.25, 35.0, 35.25, 35.5,
                  37.0, 37.25, 39.0, 39.25, 39.5, 41.0, 41.25, 43.0, 43.25,
                  43.5, 45.0, 45.25, 47.0, 47.25, 47.5, 49.0, 49.25, 51.0,
                  51.25, 51.5, 53.0, 53.25, 56.0, 56.5, 57.0, 57.5, 58.0, 58.5,
                  59.0, 59.5, 60.0, 60.5, 61.0, 61.5, 62.0, 62.5, 63.0, 63.5,
                  64.0, 64.5, 65.0, 65.5, 66.0, 66.5, 67.0, 67.5, 68.0, 68.5,
                  69.0, 69.5, 70.0, 70.5, 71.0, 71.5, 73.0, 73.25, 75.0, 75.25,
                  75.5, 77.0, 77.25, 79.0, 79.25, 79.5, 81.0, 81.25, 83.0,
                  83.25, 83.5, 85.0, 85.25, 87.0, 87.25, 87.5, 88.0, 88.5, 89.0,
                  89.5, 90.0, 90.5, 91.0, 91.5, 92.0, 92.5, 93.0, 93.5, 94.0,
                  94.5, 95.0,
                ],
                bpm: 134,
                volumeBase: 0.5,
                volumeScale: 1.0,
                beatIndex: 0,

                head: "head2",
                credits: "creditsMartyn",
              },

              song3: {
                id: "song3",
                src: "https://fractalfantasy.net/uncannyvalley/uncannyvalley/sounds/LUZ%20(altered%20qualia)%202.m4a",

                audioElement: null,
                buttonElement: null,
                creditsElement: null,

                audioBuffer: null,
                audioBufferSource: null,
                audioBufferGain: null,

                audioBufferStartTime: 0.0,
                audioBufferOffsetTime: 0.0,
                audioBufferPlaying: false,

                beats: [
                  0.0, 0.5, 1.0, 1.25, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.25,
                  6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.25, 10.0, 10.5, 11.0,
                  11.5, 12.0, 12.5, 13.0, 13.25, 14.0, 14.5, 15.0, 15.0833,
                  15.1667, 15.25, 15.3333, 15.4167, 15.5, 15.5417, 15.5833,
                  15.625, 15.6667, 15.7083, 15.75, 15.7917, 15.8333, 15.875,
                  15.9167, 15.9583, 16.0, 17.75, 18.0, 19.75, 19.8125, 19.875,
                  19.9375, 20.0, 21.75, 22.0, 24.0, 25.75, 26.0, 27.75, 27.8125,
                  27.875, 27.9375, 28.0, 29.75, 30.0, 31.0, 31.0833, 31.1667,
                  31.25, 31.3333, 31.4167, 31.5, 31.5417, 31.5833, 31.625,
                  31.6667, 31.7083, 31.75, 31.7917, 31.8333, 31.875, 31.9167,
                  31.9583, 32.0, 33.0, 33.0833, 33.1667, 33.25, 33.3333,
                  33.4167, 33.5, 33.5417, 33.5833, 33.625, 33.6667, 33.7083,
                  33.75, 33.7917, 33.8333, 33.875, 33.9167, 33.9583, 34.0, 36.0,
                  37.0, 37.0833, 37.1667, 37.25, 37.3333, 37.4167, 37.5,
                  37.5417, 37.5833, 37.625, 37.6667, 37.7083, 37.75, 37.7917,
                  37.8333, 37.875, 37.9167, 37.9583, 38.0, 40.0, 41.0, 41.0833,
                  41.1667, 41.25, 41.3333, 41.4167, 41.5, 41.5417, 41.5833,
                  41.625, 41.6667, 41.7083, 41.75, 41.7917, 41.8333, 41.875,
                  41.9167, 41.9583, 42.0, 44.0, 45.0, 45.0833, 45.1667, 45.25,
                  45.3333, 45.4167, 45.5, 45.5417, 45.5833, 45.625, 45.6667,
                  45.7083, 45.75, 45.7917, 45.8333, 45.875, 45.9167, 45.9583,
                  46.0, 48.0, 49.75, 50.0, 51.75, 51.8125, 51.875, 51.9375,
                  52.0, 53.75, 54.0, 55.0, 55.0833, 55.1667, 55.25, 55.3333,
                  55.4167, 55.5, 55.5417, 55.5833, 55.625, 55.6667, 55.7083,
                  55.75, 55.7917, 55.8333, 55.875, 55.9167, 55.9583, 56.0,
                  56.375, 56.75, 57.0, 57.375, 57.75, 58.0, 58.375, 58.75, 59.0,
                  59.375, 59.75, 59.8125, 59.875, 59.9375, 60.0, 60.375, 60.75,
                  61.0, 61.375, 61.75, 62.0, 62.375, 62.75, 63.0, 63.0833,
                  63.1667, 63.25, 63.3333, 63.4167, 63.5, 63.5417, 63.5833,
                  63.625, 63.6667, 63.7083, 63.75, 63.7917, 63.8333, 63.875,
                  63.9167, 63.9583, 64.0, 64.375, 64.75, 65.0, 65.375, 65.75,
                  66.0, 66.375, 66.75, 67.0, 67.375, 67.75, 67.8125, 67.875,
                  67.9375, 68.0, 68.375, 68.75, 69.0, 69.375, 69.75, 70.0,
                  70.375, 70.75, 71.0, 71.0833, 71.1667, 71.25, 71.3333,
                  71.4167, 71.5, 71.5417, 71.5833, 71.625, 71.6667, 71.7083,
                  71.75, 71.7917, 71.8333, 71.875, 71.9167, 71.9583, 72.0,
                  72.375, 72.75, 73.0, 73.375, 73.75, 74.0, 74.375, 74.75, 75.0,
                  75.375, 75.75, 75.8125, 75.875, 75.9375, 76.0, 76.375, 76.75,
                  77.0, 77.375, 77.75, 78.0, 78.375, 78.75, 79.0, 79.0833,
                  79.1667, 79.25, 79.3333, 79.4167, 79.5, 79.5417, 79.5833,
                  79.625, 79.6667, 79.7083, 79.75, 79.7917, 79.8333, 79.875,
                  79.9167, 79.9583, 80.0, 81.0, 81.0833, 81.1667, 81.25,
                  81.3333, 81.4167, 81.5, 81.5417, 81.5833, 81.625, 81.6667,
                  81.7083, 81.75, 81.7917, 81.8333, 81.875, 81.9167, 81.9583,
                  82.0, 84.0, 85.0, 85.0833, 85.1667, 85.25, 85.3333, 85.4167,
                  85.5, 85.5417, 85.5833, 85.625, 85.6667, 85.7083, 85.75,
                  85.7917, 85.8333, 85.875, 85.9167, 85.9583, 86.0, 88.0, 89.0,
                  89.0833, 89.1667, 89.25, 89.3333, 89.4167, 89.5, 89.5417,
                  89.5833, 89.625, 89.6667, 89.7083, 89.75, 89.7917, 89.8333,
                  89.875, 89.9167, 89.9583, 90.0, 92.0, 93.0, 93.0833, 93.1667,
                  93.25, 93.3333, 93.4167, 93.5, 93.5417, 93.5833, 93.625,
                  93.6667, 93.7083, 93.75, 93.7917, 93.8333, 93.875, 93.9167,
                  93.9583, 94.0,
                ],
                bpm: 100,
                volumeBase: 0.5,
                volumeScale: 1.0,
                beatIndex: 0,

                head: "head1",
                credits: "creditsZora",
              },
            };

            var songList = [];

            for (var id in configSong) {
              var song = configSong[id];

              var buttonElement = document.getElementById(id + "button");
              var creditsElement = document.getElementById(song["credits"]);

              song["buttonElement"] = buttonElement;
              song["creditsElement"] = creditsElement;

              if (useAudioBuffers) {
                loadSong(song);
              } else {
                //var audioElement = document.getElementById( id );

                var audioElement = document.createElement("audio");
                audioElement.src = song["src"];

                song["audioElement"] = audioElement;
              }

              songList.push(song);
            }

            // --------------------------------------------------------------

            var configHeads = {
              // BLACK MAN

              head1: {
                root: null,
                rootOffset: [5, 100, 0],
                meshOffset: [-55, -400, -55],

                eyeScale: 150,
                leftEyePos: [53, 61, 118 + 2],
                rightEyePos: [-64, 58, 118 + 2],

                eyesInnerRightRot: [-0.05, Math.PI + 0.1, 0.0],
                eyesInnerLeftRot: [-0.025, Math.PI - 0.025, 0.0],

                diffuseMap: "./assets/Head_01_Diffuse_2k.jpg",
                bumpMap: "./assets/Head_01_Bump_2k.jpg",
                glossMap: "./assets/Head_01_Gloss_2k.jpg",

                irises: [
                  {
                    type: "phong",

                    map: "eyeDynamicPupilMap",
                    dynamicData: {
                      map: "darkEyeGrayMap",
                      pupilSize: 160,
                      pupilMaxSize: 160,
                      irisSaturation: 1,
                      irisBrightness: 1,
                      scleraBrightness: 0.95,
                      causticBrightness: 8,
                    },

                    specularMap: "darkEyeSpecularMap",

                    bumpMap: "darkEyeBumpMap",
                    bumpScale: 2,
                  },

                  //--------------------------------------------------------------

                  {
                    type: "phong",
                    map: "eyeAfroVideoMap",
                    requires: "videoTexture",
                    altMap: "eyeAfroMap",
                  },

                  //--------------------------------------------------------------

                  {
                    type: "phong",

                    map: "eyeDynamicPupilMap",
                    dynamicData: {
                      map: "darkEyeGrayMap",
                      pupilSize: 160,
                      pupilMaxSize: 160,
                      irisSaturation: 1,
                      irisBrightness: 1,
                      scleraBrightness: 0.95,
                      causticBrightness: 8,
                    },

                    overlay: "eyeEmissiveCanvasMap",
                    overlayData: {
                      colorHSL: [10, 99, 85],
                      intensity: 1,

                      pattern: "autoCycle",
                      patternDuration: 1,
                      patternBeatIndex: 0,
                      patternIndex: 0,
                      patternList: [
                        "irisCross",
                        "irisCrossRotating",
                        "irisCrossPulsating",
                        "pupilRingSolidPulsating",
                      ],
                      tempo: 0.025,

                      requires: "canvasTexture",
                      altMap: "emissiveRedCrossMap",
                    },

                    specularMap: "darkEyeSpecularMap",

                    bumpMap: "darkEyeBumpMap",
                    bumpScale: 2,
                  },
                ],

                currentIrisTextureType: null,
                currentOverlayTextureType: null,
                currentOverlayData: null,
                currentDynamicData: null,

                diffuseTex: null,
                bumpTex: null,
                glossTex: null,

                itemsToLoad: 4,
                itemCounter: 0,

                meshes: {
                  leftEye: null,
                  rightEye: null,
                  leftEyeOverlay: null,
                  rightEyeOverlay: null,
                  head: null,
                },

                headMaterials: [],
                headMaterialsIndex: 0,

                lightColorHSV: [0.06, 0.0, 0.85],
                backLightMultiplier: 3,
                backLightBaseline: 0.5,

                volumeNormalization: {
                  song1: 1.0,
                  song2: 1.0,
                  song3: 1.0,
                },

                loadingElement: null,
                song: null,

                eyeFollow: false,
                eyeBehaviorType: initEyeBehaviorType,
                eyeBehaviorCountDown: initEyeBehaviorCountDown,

                loaded: false,
              },

              // WHITE MAN

              head2: {
                root: null,
                rootOffset: [0, 100, 0],
                meshOffset: [-75, -450, 50],

                eyeScale: 150 * 1,
                leftEyePos: [50, 61, 116 + 3 - 0],
                rightEyePos: [-56, 61, 118 + 3 - 2],

                eyesInnerRightRot: [0.0, Math.PI, 0.0],
                eyesInnerLeftRot: [0.0, Math.PI, 0.0],

                diffuseMap: "./assets/Head_02_Diffuse_2k.jpg",
                bumpMap: "./assets/Head_02_Bump_2k.jpg",
                glossMap: "./assets/Head_02_Gloss_2k.jpg",

                irises: [
                  {
                    type: "phong",

                    map: "eyeDynamicPupilMap",
                    dynamicData: {
                      map: "eyeBlueMap",
                      pupilSize: 155,
                      pupilMaxSize: 155,
                      irisSaturation: 0.6,
                      irisBrightness: 1,
                      scleraBrightness: 0.93,
                      causticBrightness: 6,
                    },

                    bumpMap: "eyeBumpMap",
                    bumpScale: 5,
                  },

                  //--------------------------------------------------------------

                  {
                    type: "metallic",
                    map: "eyeMetallicMap",
                    bumpMap: "eyeBumpMap",
                    bumpScale: 1.5,
                  },

                  //--------------------------------------------------------------

                  {
                    type: "phong",

                    map: "eyeDynamicPupilMap",
                    dynamicData: {
                      map: "eyeBlueMap",
                      pupilSize: 155,
                      pupilMaxSize: 155,
                      irisSaturation: 0.65,
                      irisBrightness: 0.95,
                      scleraBrightness: 0.93,
                      causticBrightness: 6,
                    },

                    overlay: "eyeEmissiveCanvasMap",
                    overlayData: {
                      colorHSL: [190, 95, 75],
                      intensity: 1,

                      pattern: "autoCycle",
                      patternDuration: 2,
                      patternBeatIndex: 0,
                      patternIndex: 0,
                      patternList: [
                        "pupilRingBands",
                        "irisRingInner",
                        "irisRingInnerRotating",
                        "irisRingInnerOuter",
                        "irisRingInnerOuterRotating",
                        "irisRingInner",
                        "irisRingInnerRotating",
                      ],
                      tempo: 0.25,

                      requires: "canvasTexture",
                      altMap: "emissiveBlueCircleMap",
                    },
                  },
                ],

                currentIrisTextureType: null,
                currentOverlayTextureType: null,
                currentOverlayData: null,
                currentDynamicData: null,

                diffuseTex: null,
                bumpTex: null,
                glossTex: null,

                itemsToLoad: 4,
                itemCounter: 0,

                meshes: {
                  leftEye: null,
                  rightEye: null,
                  leftEyeOverlay: null,
                  rightEyeOverlay: null,
                  head: null,
                },

                headMaterials: [],
                headMaterialsIndex: 0,

                lightColorHSV: [0.6, 0.15, 1],
                backLightMultiplier: 2.0,
                backLightBaseline: 0.25,

                volumeNormalization: {
                  song1: 1.0,
                  song2: 0.8,
                  song3: 1.0,
                },

                loadingElement: null,
                song: null,

                eyeFollow: false,
                eyeBehaviorType: initEyeBehaviorType,
                eyeBehaviorCountDown: initEyeBehaviorCountDown,

                loaded: false,
              },

              // OLD MAN

              head3: {
                root: null,
                rootOffset: [0, 95, 0],
                meshOffset: [-75, -450, 50],

                eyeScale: 150,
                leftEyePos: [49, 68, 120 + 2],
                rightEyePos: [-50, 65, 121 + 2],

                eyesInnerRightRot: [0.0, Math.PI, 0.0],
                eyesInnerLeftRot: [0.0, Math.PI, 0.0],

                diffuseMap: "./assets/Head_03_Colour_2K.jpg",
                bumpMap: "./assets/Head_03_Bump_2K.jpg",
                glossMap: "./assets/Head_03_Gloss_2k.jpg",

                irises: [
                  {
                    type: "phong",

                    map: "eyeDynamicPupilMap",
                    dynamicData: {
                      map: "eyeSteelMap",
                      pupilSize: 160,
                      pupilMaxSize: 160,
                      irisSaturation: 1,
                      irisBrightness: 1,
                      scleraBrightness: 0.95,
                      causticBrightness: 4,
                    },

                    bumpMap: "eyeBumpMap",
                    bumpScale: 5,
                  },

                  //--------------------------------------------------------------

                  {
                    type: "phong",

                    map: "eyeSteelMap",

                    overlay: "eyeEmissiveCanvasMap",
                    overlayData: {
                      colorHSL: [180, 99, 99],
                      intensity: 2,

                      pattern: "autoCycle",
                      patternDuration: 5,
                      patternBeatIndex: 4,
                      patternIndex: 4,
                      patternList: [
                        ,
                        "irisCross",
                        "irisCrossRotating",
                        "irisCrossPulsating",
                        "pupilRingSolidPulsatingDouble",
                        "pupilRingSolidPulsating",
                      ],
                      tempo: 0.1,

                      requires: "canvasTexture",
                      altMap: "emissiveBlueCrossMap",
                    },

                    bumpMap: "eyeBumpMap",
                    bumpScale: 5,
                  },

                  //--------------------------------------------------------------

                  {
                    type: "metallic",
                    map: "eyePearlVideoMap",
                    requires: "videoTexture",
                    altMap: "eyePearlMap",
                  },
                ],

                currentIrisTextureType: null,
                currentOverlayTextureType: null,
                currentOverlayData: null,
                currentDynamicData: null,

                diffuseTex: null,
                bumpTex: null,
                glossTex: null,

                itemsToLoad: 4,
                itemCounter: 0,

                meshes: {
                  leftEye: null,
                  rightEye: null,
                  leftEyeOverlay: null,
                  rightEyeOverlay: null,
                  head: null,
                },

                headMaterials: [],
                headMaterialsIndex: 0,

                lightColorHSV: [0.6, 0.0, 1],
                backLightMultiplier: 3,
                backLightBaseline: 0.5,

                volumeNormalization: {
                  song1: 0.8,
                  song2: 0.5,
                  song3: 0.5,
                },

                loadingElement: null,
                song: null,

                eyeFollow: false,
                eyeBehaviorType: initEyeBehaviorType,
                eyeBehaviorCountDown: initEyeBehaviorCountDown,

                loaded: false,
              },
            };

            configHeads[configSong["song1"]["head"]]["song"] = "song1";
            configHeads[configSong["song2"]["head"]]["song"] = "song2";
            configHeads[configSong["song3"]["head"]]["song"] = "song3";

            var headList = [];
            for (var id in configHeads) {
              var head = configHeads[id];
              headList.push(head);
            }

            // --------------------------------------------------------------

            var commonObjects = {};

            // --------------------------------------------------------------

            var shadowSides = [0, 5, 5, 5, 1];

            var lightAngles = [-0.2, -0.1, 0.05, 0.1, 0.2];
            var lightIndex = 0;

            // --------------------------------------------------------------

            var container, stats, loader;
            var camera, scene, renderer, innerRenderer;

            var keyLight;
            var backLight;

            var clock = new XG.Clock();

            //

            var mouseX = 0;
            var mouseY = 0;

            var targetX = 0,
              targetY = 0;

            var windowHalfX = window.innerWidth / 2;
            var windowHalfY = window.innerHeight / 2;

            var cameraTarget = new XG.Vector3(0, 0, 0);

            var eyeTarget = new XG.Vector3(0, 0, 0);
            var eyeX = 0;
            var eyeY = 0;

            var eyeTicker = 0;
            var eyeTargetSelected = false;
            var eyeInterval1 = 2;
            var eyeInterval2 = 4;
            var eyeRangeLo = 0.5;
            var eyeRangeHi = 1.5;

            //

            var gpuData;

            //

            configHeads["head1"]["loadingElement"] =
              document.getElementById("loading1");
            configHeads["head2"]["loadingElement"] =
              document.getElementById("loading2");
            configHeads["head3"]["loadingElement"] =
              document.getElementById("loading3");

            //

            function supportsVideo() {
              return !!document.createElement("video").canPlayType;
            }

            function supportsWebmVideo(codecs) {
              if (!supportsVideo()) {
                return false;
              }

              var v = document.createElement("video");
              return v.canPlayType('video/webm; codecs="' + codecs + '"');
            }

            function loadVideo(formats) {
              var video = document.createElement("video");
              video.setAttribute("playsinline", "");
              video.loop = true;
              video.muted = true;
              video.src =
                supportsWebmVideo("vp9") && formats["vp9"]
                  ? formats["vp9"]
                  : supportsWebmVideo("vp8") && formats["vp8"]
                  ? formats["vp8"]
                  : formats["mp4"];

              video.play();

              var textureVideo = new XG.Texture(video);
              textureVideo.format = XG.RGBFormat;
              textureVideo.generateMipmaps = true;

              return { video: video, textureVideo: textureVideo };
            }

            //

            function init() {
              container = document.createElement("div");
              document.body.appendChild(container);

              //

              scene = new XG.Scene();

              camera = new XG.PerspectiveCamera(11, WIDTH / HEIGHT, 50, 7000);
              camera.position.set(0, 320, 1800);
              cameraTarget.set(0, 150, 600);
              camera.lookAt(cameraTarget);

              // LIGHTS

              if (useKeyLight) {
                var intensity = 1.5;
                var radius = 100;
                var color = 0xffffff;
                var distance = 3000;

                keyLight = new XG.SphereLight(
                  color,
                  intensity,
                  distance,
                  radius
                );
                keyLight.position.set(1, 0.2, 1.5);
                scene.add(keyLight);

                keyLight.position.multiplyScalar(500);

                keyLight.castShadow = true;
                keyLight.shadowDarkness = 1;
                keyLight.shadowCameraNear = 1;
                keyLight.shadowCameraFar = distance;
                keyLight.shadowMapWidth = 512;
                keyLight.shadowMapHeight = 512;
              }

              if (useBackLight) {
                var intensity = 1.5;
                var radius = 50;
                var color = 0xffffff;
                var distance = 2000;
                var col = configHeads[currentHead]["lightColorHSV"];

                backLight = new XG.SphereLight(
                  color,
                  intensity,
                  distance,
                  radius
                );
                backLight.position.set(700, -150, -201);
                backLight.color.setHSV(col[0], col[1], col[2]);
                scene.add(backLight);

                backLight.castShadow = true;
                backLight.shadowDarkness = 1;
                backLight.shadowCameraNear = 1;
                backLight.shadowCameraFar = distance;
                backLight.shadowMapWidth = 128 * 1;
                backLight.shadowMapHeight = 128 * 1;
              }

              addBackground();

              // MODELS (COMMON PARTS)

              // video textures configuration

              var videoConfigs = [
                {
                  label: "eyePearlVideoMap",
                  vp9: "./assets/Video_Eye_Pearl_vp9.webm",
                  mp4: "./assets/Video_Eye_Pearl.mp4",
                },
                {
                  label: "eyeAfroVideoMap",
                  vp9: "./assets/Video_Eye_Afro_vp9.webm",
                  mp4: "./assets/Video_Eye_Afro.mp4",
                },
              ];

              // static textures configuration

              var textureConfigs = [
                {
                  label: "clutMap",
                  url: "./assets/CLUT_WhiteBalance.png",
                },

                {
                  label: "detailMap",
                  url: "./assets/Detail_Bump.jpg",
                },
                {
                  label: "eyeBumpMap",
                  url: "./assets/Eye_Bump2_1k.jpg",
                },

                {
                  label: "eyeSteelMap",
                  url: "./assets/Eye_Steel2_1k.jpg",
                },
                {
                  label: "eyeBlueMap",
                  url: "./assets/Eye_Blue2_1k.jpg",
                },
                {
                  label: "eyeMetallicMap",
                  url: "./assets/Eye_Metallic_1k.jpg",
                },

                {
                  label: "darkEyeGrayMap",
                  url: "./assets/Dark_Eye_Gray_1k.jpg",
                },
                {
                  label: "darkEyeBumpMap",
                  url: "./assets/Dark_Eye_Bump_1k.jpg",
                },
                {
                  label: "darkEyeSpecularMap",
                  url: "./assets/Dark_Eye_Specular_1k.jpg",
                },
              ];

              // platform-specific workarounds

              if (!useVideoTextures) {
                videoConfigs = [];

                textureConfigs.push({
                  label: "eyePearlMap",
                  url: "./assets/Eye_Pearl.jpg",
                });
                textureConfigs.push({
                  label: "eyeAfroMap",
                  url: "./assets/Eye_Afro.jpg",
                });
              }

              if (!useCanvasTextures) {
                textureConfigs.push({
                  label: "emissiveBlueCircleMap",
                  url: "./assets/Eye_Emissive_BlueCircle.jpg",
                });
                textureConfigs.push({
                  label: "emissiveBlueCrossMap",
                  url: "./assets/Eye_Emissive_BlueCross.png",
                });
                textureConfigs.push({
                  label: "emissiveRedCrossMap",
                  url: "./assets/Eye_Emissive_RedCross.png",
                });
              }

              // video textures

              for (var i = 0, il = videoConfigs.length; i < il; i++) {
                var videoConfig = videoConfigs[i];
                var label = videoConfig["label"];

                var video = loadVideo(videoConfig);
                video.textureVideo.properties = { videoIndex: i };

                videos[i] = video.video;
                textureVideos[i] = video.textureVideo;

                commonObjects[label] = video.textureVideo;
              }

              // static textures

              for (var i = 0, il = textureConfigs.length; i < il; i++) {
                var textureConfig = textureConfigs[i];
                var label = textureConfig["label"];
                var url = textureConfig["url"];

                var map = XG.ImageUtils.loadTexture(url);
                map.anisotropy = 8;

                commonObjects[label] = map;
              }

              // special textures

              var clut = commonObjects["clutMap"];
              clut.minFilter = clut.magFilter = XG.NearestFilter;
              clut.anisotropy = 0;
              clut.flipY = false;

              var detailMap = commonObjects["detailMap"];
              detailMap.wrapS = detailMap.wrapT = XG.RepeatWrapping;
              detailMap.anisotropy = 8;

              var dummyWhiteMap = XG.ImageUtils.generateDataTexture(
                4,
                4,
                new XG.Color(0xffffff)
              );
              var dummyBlackMap = XG.ImageUtils.generateDataTexture(
                4,
                4,
                new XG.Color(0x000000)
              );
              dummyWhiteMap.anisotropy = 8;
              dummyBlackMap.anisotropy = 8;

              commonObjects["whiteMap"] = dummyWhiteMap;
              commonObjects["blackMap"] = dummyBlackMap;

              commonObjects["eyeDynamicPupilMap"] = dummyBlackMap;

              // procedural textures

              if (useCanvasTextures) {
                var emissiveCanvas = generateCanvasTexture(512, 512);
                var eyeEmissiveCanvasMap = new XG.Texture(emissiveCanvas);
                eyeEmissiveCanvasMap.needsUpdate = true;

                commonObjects["eyeEmissiveCanvasMap"] = eyeEmissiveCanvasMap;
              }

              // materials

              var mouthMaterial = new XG.PhongMaterial({ color: 0x000000 });

              var eyesOuterMaterial = new XG.PhongMaterial({
                color: 0x000000,
                specular: 0xcccccc,
                shininess: 8192,
                transparent: true,
                opacity: 0.99,
                blending: XG.AdditiveBlending,
              });

              var eyesInnerPhongMaterial = new XG.PhongMaterial({
                map: dummyWhiteMap,
                specularMap: dummyWhiteMap,
                bumpScale: 1.0,
                color: 0xffffff,
                specular: 0x2b2b2b,
                shininess: 0,
                wrapAround: true,
              });

              eyesInnerPhongMaterial.specular.setHSV(0, 0, 0.95);
              eyesInnerPhongMaterial.shininess = 20;

              var eyesInnerMetallicMaterial = new XG.PhongMaterial({
                specularMap: dummyWhiteMap,
                bumpScale: 1.0,
                color: 0x000000,
                specular: 0xffffff,
                shininess: 12,
                wrapAround: false,
              });

              var eyesInnerEmissiveMaterial = new XG.EmissiveMaterial({
                color: 0xffffff,
                intensity: 1.0,
              });

              var eyesOverlayMaterial = new XG.EmissiveMaterial({
                color: 0xffffff,
                intensity: 1.0,
                transparent: true,
                blending: XG.AdditiveBlending,
              });

              commonObjects["mouthMaterial"] = mouthMaterial;
              commonObjects["eyesOuterMaterial"] = eyesOuterMaterial;
              commonObjects["eyesInnerPhongMaterial"] = eyesInnerPhongMaterial;
              commonObjects["eyesInnerEmissiveMaterial"] =
                eyesInnerEmissiveMaterial;
              commonObjects["eyesInnerMetallicMaterial"] =
                eyesInnerMetallicMaterial;
              commonObjects["eyesOverlayMaterial"] = eyesOverlayMaterial;

              //

              loader = new XG.CTMLoader();
              loader.load("./assets/EyeRightCurved.ctm", function (geometry) {
                commonObjects["eyeInnerCurvedGeo"] = geometry;
                eyeInnerCurvedLoadedCallback(geometry);
              });
              loader.load("./assets/EyeRight.ctm", function (geometry) {
                commonObjects["eyeInnerGeo"] = geometry;
                eyeInnerLoadedCallback(geometry);
              });
              loader.load("./assets/LensRight.ctm", function (geometry) {
                commonObjects["eyeOuterGeo"] = geometry;
                eyeOuterLoadedCallback(geometry);
              });

              // MODELS

              loadTextures("head3", loadCallback3);
              loadTextures("head2", loadCallback2);
              loadTextures("head1", loadCallback1);

              loader.load("./assets/Head_03.ctm", function (geometry) {
                createScene3("head3", geometry, 150);
              });
              loader.load("./assets/Head_02.ctm", function (geometry) {
                createScene2("head2", geometry, 150);
              });
              loader.load("./assets/Head_01.ctm", function (geometry) {
                createScene1("head1", geometry, 150);
              });

              // RENDERER

              var pars = {
                antialias: true,
                dither: true,
                tonemapping: XG.Filmic2015Operator,
                brightness: BRIGHTNESS,
                clearColor: 0x040404,
                clearAlpha: 1,
                alpha: false,
                width: WIDTH,
                height: HEIGHT,
                scale: SCALE,
                useMultipleRenderTargets: useMRT,
              };

              if (useDeferred) {
                renderer = new XG.DeferredRenderer(pars);
                innerRenderer = renderer.renderer;
              } else {
                pars.antialias = false;
                pars.devicePixelRatio = 1.0;

                renderer = new XG.ForwardRenderer(pars);
                innerRenderer = renderer;
              }

              renderer.domElement.style.position = "absolute";
              //renderer.domElement.style.top = MARGIN + "px";
              //renderer.domElement.style.left = "0px";
              renderer.domElement.style.top = "0px";
              renderer.domElement.style.left = SIDE_MARGIN + "px";

              renderer.domElement.style.position = "absolute";
              container.appendChild(renderer.domElement);

              //

              if (useShadowmaps) {
                renderer.shadowMapEnabled = true;

                if (useDepthTextures) {
                  renderer.shadowMapUseDepthTextures = true;
                  renderer.shadowMapDepthTextureBias = 0.04;
                } else {
                  renderer.shadowMapSlopeBias = 0.000005;
                }

                renderer.shadowMapCullFace = XG.CullFaceNone;
                renderer.shadowMapType = XG.PCFSoftHQShadowMap;

                renderer.shadowMapSlopeDepthBias = true;
                renderer.shadowMapSlopeScale = 8;
                renderer.shadowMapSlopeBias = 0.0;
                renderer.shadowMapSlopeMax = 0.5;

                //renderer.shadowMapDebug = true;

                if (isMobile) {
                  renderer.shadowMapUseDepthTextures = false;
                  renderer.shadowMapSlopeBias = 0.000005;
                }
              }

              //

              renderer.dofEnabled = true;
              renderer.dofAutofocus = true;
              renderer.dofFancy = true;
              renderer.dofLensFstop = 1.4;
              renderer.dofLensBlurScale = 12;

              renderer.dofFocusWidth = 100;
              renderer.dofFocusRampWidth = 100;
              renderer.dofMaxBlur = 0.2;

              var fovRad = XG.Math.degToRad(camera.fov);
              renderer.dofLensFocalLength = XG.Math.fovToFocalLength(
                fovRad,
                24
              );

              // POST-EFFECTS

              effectColorCorrection = new XG.ShaderPass(XG.CLUTShader);
              effectColorCorrection.material.uniforms.tCLUT.value = clut;

              if (useDeferred) {
                renderer.addEffect(effectColorCorrection);
              } else {
                var scaledWidth = Math.floor(WIDTH * SCALE_FORWARD);
                var scaledHeight = Math.floor(HEIGHT * SCALE_FORWARD);

                var renderScene = new XG.RenderPass(scene, camera);

                effectCopy = new XG.ShaderPass(XG.CopyShader);
                effectCopy.renderToScreen = true;

                effectFXAA = new XG.ShaderPass(XG.FXAAShader);
                effectFXAA.uniforms["resolution"].value.set(
                  1 / scaledWidth,
                  1 / scaledHeight
                );

                composer = new XG.EffectComposer(renderer);
                composer.setSize(scaledWidth, scaledHeight);

                composer.addPass(renderScene);
                composer.addPass(effectColorCorrection);
                composer.addPass(effectFXAA);
                composer.addPass(effectCopy);
              }

              // STATS

              if (statsEnabled) {
                stats = new Stats();
                container.appendChild(stats.domElement);
              }

              // EVENTS

              document.addEventListener(
                "mousemove",
                onDocumentMouseMove,
                false
              );
              document.addEventListener("touchmove", onTouchMove, {
                passive: false,
              });
              document.addEventListener("keydown", onDocumentKeyDown, false);
              renderer.domElement.addEventListener("click", onClick, false);
              window.addEventListener("resize", onWindowResize, false);

              //

              addButtonHandlers();

              //

              if (!useAudioBuffers) setupVisibilityHander();

              if (useShaderTextures) {
                setupDynamicTexture();
              }

              // INITIAL STATE

              var gpuDetector = new GPUDetector();
              gpuData = gpuDetector.detectGPU();

              if (gpuData && gpuData.rawScore >= ULTRA_THRESHOLD) toggleUltra();

              setZoom(0);
              refreshDebug();

              //

              playButtonElement.addEventListener(
                "click",
                function () {
                  console.log(currentSong);

                  var song = configSong[currentSong];

                  if (useAudioBuffers) {
                    playAudioBufferSource(song);
                  } else {
                    var audio = song["audioElement"];
                    handlePlay(audio);
                  }

                  if (audioCtx) audioCtx.resume();

                  hideButton();
                },
                false
              );

              centerButton();

              //

              RESIZE_HACK = 1;
              onWindowResize();
            }

            // -----------------------------------------------------------------------------------

            function playAudioBufferSource(song) {
              if (useAudioContextResetHack) {
                resetAudioContext();
                wireAudioGraph();
              }

              //

              var audioSrc = audioCtx.createBufferSource();

              audioSrc.buffer = song["audioBuffer"];

              audioSrc.addEventListener("ended", (event) => {
                console.log("song ended", song);

                if (song["audioBufferPlaying"]) {
                  song["beatIndex"] = 0;
                  song["audioBufferOffsetTime"] = 0;

                  playAudioBufferSource(song);
                }
              });

              var gainNode = audioCtx.createGain();
              gainNode.gain.value = song["volumeBase"] * song["volumeScale"];

              audioSrc.connect(gainNode);
              gainNode.connect(analyser);
              analyser.connect(audioCtx.destination);

              //audioSrc.connect( analyser );
              //analyser.connect( audioCtx.destination );

              song["audioBufferSource"] = audioSrc;
              song["audioBufferGain"] = gainNode;
              song["audioBufferStartTime"] = audioCtx.currentTime;
              song["audioBufferPlaying"] = true;

              var offsetTime = song["audioBufferOffsetTime"];

              audioSrc.start(0, offsetTime);

              playingAudio = true;
            }

            // -----------------------------------------------------------------------------------

            function setupDynamicTexture() {
              var rtWidth = 512 * 1;
              var rtHeight = 512 * 1;

              var rtParamsUByte = {
                minFilter: XG.LinearMipMapLinearFilter,
                magFilter: XG.LinearFilter,
                wrapS: XG.RepeatWrapping,
                wrapT: XG.RepeatWrapping,
                stencilBuffer: false,
                format: XG.RGBAFormat,
                type: XG.UnsignedByteType,
              };

              var rtDiffuse = new XG.RenderTarget(
                rtWidth,
                rtHeight,
                rtParamsUByte
              );
              rtDiffuse.generateMipmaps = true;
              rtDiffuse.depthBuffer = false;
              rtDiffuse.stencilBuffer = false;

              var vertexShader =
                XG.ShaderChunk["vertexShaderFullscreenTriangleUV"];

              var uniformsDiffuse = {
                diffuseSource: { type: "t", value: null },
                resolution: { type: "v2", value: new XG.Vector2(512, 512) },

                level: { type: "f", value: 0 },

                irisRadius: { type: "f", value: 0 },
                irisCenter: { type: "v2", value: new XG.Vector2(0, 0) },

                causticCenter: { type: "v2", value: new XG.Vector2(0, 0) },
                causticBrightness: { type: "f", value: 0.0 },

                irisSaturation: { type: "f", value: 1.0 },
                irisBrightness: { type: "f", value: 1.0 },
                scleraBrightness: { type: "f", value: 1.0 },
              };

              var fragmentShaderDiffuse = [
                "uniform sampler2D diffuseSource;",
                "uniform vec2 resolution;",

                "uniform float level;",

                "uniform float irisRadius;",
                "uniform vec2 irisCenter;",

                "uniform vec2 causticCenter;",
                "uniform float causticBrightness;",

                "uniform float irisSaturation;",
                "uniform float irisBrightness;",
                "uniform float scleraBrightness;",

                "varying vec2 vUv;",

                "const vec3 LUMA = vec3( 0.2126, 0.7152, 0.0722 );",

                "vec2 bulgePinch( vec2 coord, vec2 center, float radius, float strength ) {",

                "vec2 tmpCoord = coord - center;",
                "float distance = length( tmpCoord );",

                "if ( distance < radius ) {",

                "float percent = distance / radius;",
                "if ( strength > 0.0 ) {",

                "tmpCoord *= mix( 1.0, smoothstep( 0.0, radius / distance, percent ), strength * 0.75 );",

                "} else {",

                "tmpCoord *= mix( 1.0, pow( percent, 1.0 + strength * 0.75 ) * radius / distance, 1.0 - percent );",

                "}",

                "}",

                "tmpCoord += center;",

                "return tmpCoord;",

                "}",

                "void main() {",

                "float s = clamp( -0.5 + level/100.0, -0.5, 0.75 );",
                "vec2 texCoord = bulgePinch( vUv * resolution, irisCenter, irisRadius, s );",
                "vec4 texel = texture2D( diffuseSource, texCoord / resolution );",

                "float luma = dot( texel.rgb, LUMA );",

                "float v = irisBrightness;",
                "float r = length( vUv * resolution - irisCenter );",
                "if ( r > irisRadius ) v = scleraBrightness;",
                "if ( r < irisRadius ) texel.rgb = mix( vec3( luma ), texel.rgb, irisSaturation );",

                "mgl_FragColor.rgb = texel.rgb * v;",
                "mgl_FragColor.a = 1.0;",

                //

                "float r2 = length( vUv * resolution - irisCenter + causticCenter );",
                "float extraLight = max( 0.95 - r2 / irisRadius, 0.0 ) * causticBrightness;",
                "if ( r > irisRadius ) extraLight = 0.0;",

                "mgl_FragColor.rgb += extraLight * gl_FragColor.rgb * gl_FragColor.rgb * ( 1.0 - r/irisRadius) * luma;",

                "}",
              ].join("\n");

              var diffuseShader = {
                fragmentShader: fragmentShaderDiffuse,
                vertexShader: vertexShader,
                uniforms: uniformsDiffuse,
              };

              var passDiffuse = new XG.ShaderPass(diffuseShader);

              diffuseComposer = new XG.EffectComposer(innerRenderer, rtDiffuse);
              diffuseComposer.addPass(passDiffuse);

              var scaleX = rtWidth / 1024;
              var scaleY = rtHeight / 1024;

              var cx = rtWidth * 0.5 + 5 * scaleX;
              var cy = rtHeight * 0.5 - 5 * scaleX;

              var pupilRadius = 54 * scaleX;
              var irisRadius = 180 * scaleX;

              diffuseUniforms = passDiffuse.uniforms;
              diffuseUniforms["resolution"].value.set(rtWidth, rtHeight);

              diffuseUniforms["irisCenter"].value.set(cx, cy);
              diffuseUniforms["irisRadius"].value = irisRadius;

              diffuseUniforms["diffuseSource"].value =
                commonObjects["blackMap"];

              commonObjects["eyeDynamicPupilMap"] =
                diffuseComposer.renderTarget1;
            }

            // --------------------------------------------------------------

            function renderRadialLayer(
              ctx,
              frequencies,
              cx,
              cy,
              r,
              thickness,
              n,
              nn,
              hue,
              saturation,
              lightness
            ) {
              var length = frequencies.length;
              var n1 = n - 1;
              var colorChunk = "hsl(" + hue + "," + saturation + "%,";

              var pi2 = Math.PI * 2;
              var unit = (pi2 / length) * 0.9;
              var gap = (pi2 / length) * 0.1;

              var fVal, sa, ea, color, lightnessNorm;

              var fCum = 0;
              var fNorm = n * 255;

              ctx.lineWidth = thickness;

              for (var j = 0; j < length; j += 1) {
                fVal = frequencies[j];
                fCum += fVal;

                if (j % n === n1) {
                  sa = j * (unit + gap);
                  ea = sa + (unit + gap) * nn;

                  if (j == n1) fCum *= 0.33;
                  if (j == n1 + n) fCum *= 0.66;

                  lightnessNorm = Math.min(
                    lightness * (fCum / fNorm),
                    lightness
                  );
                  color = colorChunk + lightnessNorm + "%)";
                  ctx.strokeStyle = color;

                  ctx.beginPath();
                  ctx.arc(cx, cy, r, sa, ea, 0);
                  ctx.stroke();

                  fCum = 0;
                }
              }
            }

            function updateCanvas(
              level,
              frequencies,
              wasChange,
              time,
              bpm,
              overlayData
            ) {
              var map = commonObjects["eyeEmissiveCanvasMap"];
              var canvas = map.image;
              var ctx = canvas.getContext("2d");

              var width = canvas.width;
              var height = canvas.height;

              var r, d, w, color;

              var scalex = width / 1024;
              var scaley = height / 1024;

              var scale = scalex;

              var cx = width * 0.5 + 5 * scalex;
              var cy = height * 0.5 - 5 * scaley;

              //

              var tempoScale = overlayData.tempo ? overlayData.tempo : 1;
              var tempo = bpm * tempoScale;

              var pattern = overlayData.pattern;
              var patternList = overlayData.patternList;
              var patternDuration = overlayData.patternDuration;

              var hue = overlayData.colorHSL[0];
              var saturation = overlayData.colorHSL[1];
              var lightness = overlayData.colorHSL[2];

              //

              var rotation = false;

              var pupilBorderPulsating = false;
              var pupilBorder = false;
              var irisBorder = false;

              var pupilCross = false;
              var irisCross = false;

              var innerRadialLayer1 = false;
              var innerRadialLayer2 = false;
              var innerRadialLayer3 = false;

              var outerRadialLayer1 = false;
              var outerRadialLayer2 = false;

              var innerRadialLayer1Rotation = false;
              var innerRadialLayer2Rotation = false;
              var outerRadialLayer2Rotation = false;

              //

              if (pattern === "autoCycle") {
                if (wasChange) {
                  overlayData.patternBeatIndex += 1;

                  if (overlayData.patternBeatIndex % patternDuration === 0) {
                    overlayData.patternIndex =
                      (overlayData.patternIndex + 1) % patternList.length;
                  }
                }

                pattern = patternList[overlayData.patternIndex];
              }

              //

              if (pattern === "irisCross") {
                irisCross = true;
                pupilBorder = true;
              } else if (pattern === "irisCrossPulsating") {
                irisCross = true;
                pupilBorder = true;
                pupilBorderPulsating = true;
              } else if (pattern === "irisCrossRotating") {
                irisCross = true;
                pupilBorder = true;
                rotation = true;
              } else if (pattern === "pupilCross") {
                pupilCross = true;
                innerRadialLayer1 = true;
              } else if (pattern === "pupilRingBands") {
                innerRadialLayer1 = true;
              } else if (pattern === "pupilRingSolid") {
                pupilBorder = true;
              } else if (pattern === "pupilRingSolidPulsating") {
                pupilBorderPulsating = true;
              } else if (pattern === "pupilRingSolidPulsatingDouble") {
                pupilBorder = true;
                pupilBorderPulsating = true;
              } else if (pattern === "irisRingInner") {
                innerRadialLayer2 = true;
              } else if (pattern === "irisRingInnerRotating") {
                innerRadialLayer2 = true;
                innerRadialLayer2Rotation = true;
              } else if (pattern === "irisRingInnerOuter") {
                innerRadialLayer2 = true;
                outerRadialLayer2 = true;
              } else if (pattern === "irisRingInnerOuterRotating") {
                innerRadialLayer2 = true;
                outerRadialLayer2 = true;

                innerRadialLayer2Rotation = true;
              } else if (pattern === "irisRingFull") {
                innerRadialLayer2 = true;
                outerRadialLayer2 = true;
                irisBorder = true;
              }

              // clear background

              ctx.fillRect(0, 0, width, height);

              if (rotation) {
                var angle = ((Math.PI * 2) / 60) * tempo * time;

                ctx.save();
                ctx.translate(cx, cy);
                ctx.rotate(angle);
                ctx.translate(-cx, -cy);
              }

              // pupil border

              if (pupilBorder) {
                w = 15 * scale;
                r = 54 * scale;

                color = "hsl(" + hue + ",85%," + 50 * (level / 100) + "%)";

                ctx.lineWidth = w;
                ctx.strokeStyle = color;

                ctx.beginPath();
                ctx.arc(cx, cy, r, 0, 6.28, 0);
                ctx.stroke();
              }

              // pulsating pupil border

              if (pupilBorderPulsating) {
                w = 15 * scale;
                r = 54 * scale;
                r += (60 * level) / 100;

                color = "hsl(" + hue + ",85%," + 50 * (level / 100) + "%)";

                ctx.lineWidth = w;
                ctx.strokeStyle = color;

                ctx.beginPath();
                ctx.arc(cx, cy, r, 0, 6.28, 0);
                ctx.stroke();
              }

              // iris outer border

              if (irisBorder) {
                w = 15 * scale;
                r = 180 * scale;
                color = "hsl(" + hue + ",95%," + 50 * (level / 100) + "%)";

                ctx.lineWidth = w;
                ctx.strokeStyle = color;

                ctx.beginPath();
                ctx.arc(cx, cy, r, 0, 6.28, 0);
                ctx.stroke();
              }

              // pupil cross

              if (pupilCross) {
                r = 54 * scale;
                w = 15 * scale;
                color = "hsl(" + hue + ",95%," + 70 * (level / 100) + "%)";

                ctx.save();

                ctx.lineWidth = w;
                ctx.strokeStyle = color;

                ctx.translate(cx, cy);
                ctx.rotate(Math.PI * 0.1);
                ctx.translate(-cx, -cy);

                ctx.beginPath();
                ctx.moveTo(cx - r, cy);
                ctx.lineTo(cx + r, cy);
                ctx.stroke();

                ctx.moveTo(cx, cy - r);
                ctx.lineTo(cx, cy + r);
                ctx.stroke();

                ctx.restore();
              }

              // iris cross

              if (irisCross) {
                r = 54 * scale;
                d = 180 * scale;
                w = 15 * scale;
                color =
                  "hsl(" +
                  ((hue - 2.5) % 360) +
                  ",85%," +
                  40 * (level / 100) +
                  "%)";

                ctx.save();

                ctx.lineWidth = w;
                ctx.strokeStyle = color;

                ctx.translate(cx, cy);
                ctx.rotate(Math.PI * 0.09);
                ctx.translate(-cx, -cy);

                ctx.beginPath();
                ctx.moveTo(cx - d, cy);
                ctx.lineTo(cx - r, cy);
                ctx.stroke();

                ctx.moveTo(cx + r, cy);
                ctx.lineTo(cx + d, cy);
                ctx.stroke();

                ctx.moveTo(cx, cy - d);
                ctx.lineTo(cx, cy - r);
                ctx.stroke();

                ctx.moveTo(cx, cy + r);
                ctx.lineTo(cx, cy + d);
                ctx.stroke();

                ctx.restore();
              }

              // inner radial layer

              if (innerRadialLayer1) {
                var thickness = 30 * scale;
                var r = 54 * scale + thickness * 0.5 + 10 * scale;

                var n = 64;
                var nn = 62;

                if (innerRadialLayer1Rotation) {
                  var angle = 0.125 * ((Math.PI * 2) / 60) * tempo * time;

                  ctx.save();
                  ctx.translate(cx, cy);
                  ctx.rotate(angle);
                  ctx.translate(-cx, -cy);
                }

                renderRadialLayer(
                  ctx,
                  frequencies,
                  cx,
                  cy,
                  r,
                  thickness,
                  n,
                  nn,
                  hue,
                  saturation,
                  lightness
                );

                if (innerRadialLayer1Rotation) ctx.restore();
              }

              if (innerRadialLayer2) {
                var thickness = 50 * scale;
                var r = 54 * scale + thickness * 0.5 + 10 * scale;

                var n = 64;
                var nn = 60;

                if (innerRadialLayer2Rotation) {
                  var angle = 0.25 * ((Math.PI * 2) / 60) * tempo * time;

                  ctx.save();
                  ctx.translate(cx, cy);
                  ctx.rotate(angle);
                  ctx.translate(-cx, -cy);
                }

                renderRadialLayer(
                  ctx,
                  frequencies,
                  cx,
                  cy,
                  r,
                  thickness,
                  n,
                  nn,
                  hue,
                  saturation,
                  lightness
                );

                if (innerRadialLayer2Rotation) ctx.restore();
              }

              if (innerRadialLayer3) {
                var thickness = 120 * scale;
                var r = 54 * scale + thickness * 0.5 + 10 * scale;

                var n = 64;
                var nn = 60;

                renderRadialLayer(
                  ctx,
                  frequencies,
                  cx,
                  cy,
                  r,
                  thickness,
                  n,
                  nn,
                  hue,
                  saturation,
                  lightness
                );
              }

              // outer radial layer

              if (outerRadialLayer1) {
                var thickness = 50 * scale;
                var r = 180 * scale - thickness * 0.5;

                var n = 64;
                var nn = 62;

                renderRadialLayer(
                  ctx,
                  frequencies,
                  cx,
                  cy,
                  r,
                  thickness,
                  n,
                  nn,
                  (hue + 5) % 360,
                  saturation,
                  lightness
                );
              }

              if (outerRadialLayer2) {
                var thickness = 50 * scale;
                var r = 180 * scale - thickness * 0.5;

                var n = 32;
                var nn = 30;

                if (outerRadialLayer2Rotation) {
                  var angle = 0.5 * ((Math.PI * 2) / 60) * tempo * time;

                  ctx.save();
                  ctx.translate(cx, cy);
                  ctx.rotate(angle);
                  ctx.translate(-cx, -cy);
                }

                renderRadialLayer(
                  ctx,
                  frequencies,
                  cx,
                  cy,
                  r,
                  thickness,
                  n,
                  nn,
                  hue % 360,
                  saturation,
                  lightness
                );

                if (outerRadialLayer2Rotation) ctx.restore();
              }

              if (rotation) {
                ctx.restore();
              }

              map.needsUpdate = true;
            }

            function generateCanvasTexture(width, height) {
              var canvas = document.createElement("canvas");
              canvas.width = width;
              canvas.height = height;

              canvas.style.display = "none";
              container.appendChild(canvas);

              return canvas;
            }

            // --------------------------------------------------------------

            function launchIntoFullscreen(element) {
              if (element.requestFullscreen) {
                element.requestFullscreen();
              } else if (element.mozRequestFullScreen) {
                element.mozRequestFullScreen();
              } else if (element.webkitRequestFullscreen) {
                element.webkitRequestFullscreen();
              } else if (element.msRequestFullscreen) {
                element.msRequestFullscreen();
              }
            }

            function exitFullscreen() {
              if (document.exitFullscreen) {
                document.exitFullscreen();
              } else if (document.mozCancelFullScreen) {
                document.mozCancelFullScreen();
              } else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
              }
            }

            function isDocumentInFullScreenMode() {
              // Note that the browser fullscreen (triggered by short keys) might
              // be considered different from content fullscreen when expecting a boolean

              return (
                (document.fullscreenElement &&
                  document.fullscreenElement !== null) || // alternative standard methods
                document.mozFullScreen ||
                document.webkitIsFullScreen
              ); // current working methods
            }

            function toggleFullscreen() {
              var isFullscreen = isDocumentInFullScreenMode();

              if (isFullscreen) {
                exitFullscreen();
                elPlayer.style.display = "block";
                MARGIN = 61;
              } else {
                launchIntoFullscreen(container);
                elPlayer.style.display = "none";
                MARGIN = 0;
              }
            }

            function setZoom(index) {
              var cc = cameraConfig[index];

              camera.fov = cc[0];
              camera.position.set(cc[1], cc[2], cc[3]);

              camera.updateProjectionMatrix();

              var fovRad = XG.Math.degToRad(camera.fov);
              renderer.dofLensFocalLength = XG.Math.fovToFocalLength(
                fovRad,
                24
              );
            }

            function toggleZoom() {
              cameraIndex = (cameraIndex + 1) % cameraConfig.length;
              setZoom(cameraIndex);
            }

            //--------------------------------------------------------------

            function addButtonHandlers() {
              var elButtonSong1 = document.getElementById("song1button");
              var elButtonSong2 = document.getElementById("song2button");
              var elButtonSong3 = document.getElementById("song3button");
              var elButtonFullscreen =
                document.getElementById("fullscreenButton");

              elButtonSong1.addEventListener("click", function () {
                setSong("song1");
                setHead(configSong["song1"]["head"]);
              });

              elButtonSong2.addEventListener("click", function () {
                setSong("song2");
                setHead(configSong["song2"]["head"]);
              });

              elButtonSong3.addEventListener("click", function () {
                setSong("song3");
                setHead(configSong["song3"]["head"]);
              });

              elButtonFullscreen.addEventListener("click", function () {
                toggleFullscreen();
              });
            }

            //--------------------------------------------------------------

            function setHead(id) {
              hideHead(currentHead);
              showHead(id);

              currentHead = id;
            }

            function showHead(id) {
              var head = configHeads[id];
              var root = head["root"];
              if (!root) return;

              var col = head["lightColorHSV"];
              keyLight.color.setHSV(col[0], col[1], col[2]);

              root.traverse(function (node) {
                node.visible = true;
              });

              //

              var headMaterials = head["headMaterials"];
              var headMaterialsIndex = head["headMaterialsIndex"];
              var materials = headMaterials[head["headMaterialsIndex"]];

              var irisMap = getMaterialTexture(materials["iris"]);
              if (irisMap.properties) {
                currentVideoBase = irisMap.properties["videoIndex"];
                var video = videos[currentVideoBase];
                video.play();
              }

              //

              var overlayMap = getMaterialTexture(materials["overlay"]);
              if (overlayMap.properties) {
                currentVideoOverlay = overlayMap.properties["videoIndex"];
                var video = videos[currentVideoOverlay];
                video.play();
              }

              //

              var meshes = head["meshes"];

              var overlayMaterial = materials["overlay"];

              meshes["leftEyeOverlay"].visible = overlayMaterial.isVisible;
              meshes["rightEyeOverlay"].visible = overlayMaterial.isVisible;
            }

            function hideHead(id) {
              var head = configHeads[id];
              var root = head["root"];
              if (!root) return;

              root.traverse(function (node) {
                node.visible = false;
              });

              //

              var headMaterials = head["headMaterials"];
              var headMaterialsIndex = head["headMaterialsIndex"];
              var materials = headMaterials[head["headMaterialsIndex"]];

              var irisMap = getMaterialTexture(materials["iris"]);
              if (irisMap.properties) {
                var oldVideo = irisMap.properties["videoIndex"];
                var video = videos[oldVideo];
                video.pause();
              }

              var overlayMap = getMaterialTexture(materials["overlay"]);
              if (overlayMap.properties) {
                var oldVideo = overlayMap.properties["videoIndex"];
                var video = videos[oldVideo];
                video.pause();
              }
            }

            //--------------------------------------------------------------

            function setSong(id) {
              var oldSong = configSong[currentSong];

              if (useAudioBuffers) {
                hideButton();

                var bufferSource = oldSong["audioBufferSource"];
                if (bufferSource) {
                  oldSong["audioBufferPlaying"] = false;
                  oldSong["audioBufferOffsetTime"] =
                    audioCtx.currentTime -
                    oldSong["audioBufferStartTime"] +
                    oldSong["audioBufferOffsetTime"];

                  bufferSource.stop(0);
                }
              } else {
                oldSong["audioElement"].pause();
              }

              oldSong["buttonElement"].className = "button";
              oldSong["buttonElement"].style.display = "block";
              oldSong["creditsElement"].style.display = "none";

              currentSong = id;
              var newSong = configSong[currentSong];

              if (useAudioBuffers) {
                playAudioBufferSource(newSong);
              } else {
                var audio = newSong["audioElement"];

                if (audio.ended) {
                  newSong["beatIndex"] = 0;
                }

                if (playingAudio) {
                  handlePlay(audio);
                }
              }

              newSong["buttonElement"].className = "button playing";
              newSong["buttonElement"].style.display = "none";
              newSong["creditsElement"].style.display = "block";
            }

            // -----------------------------------------------------------------------------------

            function handlePlay(mediaElement) {
              var promise = mediaElement.play();

              if (promise !== undefined) {
                promise
                  .then(function () {
                    // Autoplay started!

                    console.log("[autoPlay started]");

                    hideButton();
                  })
                  .catch(function (error) {
                    // Autoplay was prevented.
                    // Show a "Play" button so that user can start playback.

                    console.log("[autoPlay prevented]");

                    showButton();
                    centerButton();
                  });
              }
            }

            // -----------------------------------------------------------------------------------

            function hideButton() {
              if (playButtonVisible) {
                playButtonOverlayElement.style.display = "none";
                playButtonVisible = false;
              }
            }

            function showButton() {
              if (!playButtonVisible) {
                playButtonOverlayElement.style.display = "block";
                playButtonVisible = true;
              }
            }

            function centerButton() {
              playButtonOverlayElement.style.top =
                Math.floor(
                  (window.innerHeight - playButtonOverlayElement.offsetHeight) *
                    0.5
                ) + "px";
            }

            //--------------------------------------------------------------

            function resetAudioContext() {
              // workaround for buggy Web Audio API implementation in iOS
              // (appears e.g. with headphones or bluetooth speakers, which get different sample rates than built-in internal speakers)
              // (incorrect resampling of buffers get crackling noise artefacts)

              if (audioCtx) audioCtx.close();

              audioCtx = new AudioContext({ sampleRate: 48000 });

              var source = audioCtx.createBufferSource();
              source.buffer = audioCtx.createBuffer(1, 1, 48000);
              source.connect(audioCtx.destination);

              source.start(0);
              source.disconnect();

              audioCtx.close();
            }

            //--------------------------------------------------------------

            function initAudioContext() {
              // init audio context and analyser node
              // (skip for Explorer which does support WebAudio API)

              window.AudioContext =
                window.AudioContext ||
                window.webkitAudioContext ||
                window.mozAudioContext;
            }

            function wireAudioGraph() {
              if (window.AudioContext && useAudioAnalysis) {
                audioCtx = new AudioContext({ sampleRate: 48000 });

                //

                analyser = audioCtx.createAnalyser();
                analyser.fftSize = 1024;
                analyser.smoothingTimeConstant = 0.8;

                var binCount = analyser.frequencyBinCount; // = 512
                freqByteData = new Uint8Array(binCount);

                console.log("AudioContext sample rate", audioCtx.sampleRate);
                console.log("AudioContext base latency", audioCtx.baseLatency);

                //alert( "AudioContext sample rate = [" + audioCtx.sampleRate + "] Hz" );
                //alert( "AudioContext base latency = [" + audioCtx.baseLatency + "] seconds" );
              }
            }

            //--------------------------------------------------------------

            function initAudio() {
              // fix wrong tempo from MIDI files

              for (var id in configSong) {
                var song = configSong[id];
                var beats = song["beats"];
                var bpm = song["bpm"];

                for (var i = 0, il = beats.length; i < il; i++) {
                  var timeStamp = beats[i];
                  timeStamp *= 120.0 / bpm;

                  beats[i] = timeStamp;
                }
              }

              if (useAudioBuffers) {
              } else {
                wireAudioGraph();

                // collect audio and button elements
                // and connect them to analyser node

                var generateSongEndHandler = function (id) {
                  return function () {
                    var song = configSong[id];
                    var buttonElement = song["buttonElement"];
                    buttonElement.className = "button";

                    song["beatIndex"] = 0;
                    song["audioElement"].play();
                  };
                };

                for (var id in configSong) {
                  var song = configSong[id];
                  var audioElement = song["audioElement"];

                  audioElement.volume =
                    song["volumeBase"] * song["volumeScale"];
                  audioElement.addEventListener(
                    "ended",
                    generateSongEndHandler(id)
                  );
                  //audioElement.addEventListener( "timeupdate", generateBeatsShifter( id ) );

                  if (window.AudioContext && useAudioAnalysis) {
                    var audioSrc =
                      audioCtx.createMediaElementSource(audioElement);
                    audioSrc.connect(analyser);
                    analyser.connect(audioCtx.destination);
                  }
                }

                playingAudio = true;

                // play current song

                setSong(currentSong);
              }
            }

            // --------------------------------------------------------------

            function loadSong(song) {
              if (useAudioContextResetHack && !audioCtx) {
                resetAudioContext();
                wireAudioGraph();
              }

              var url = song.src;

              console.log("loadSong", url);

              var request = new XMLHttpRequest();
              request.open("GET", url, true);
              request.responseType = "arraybuffer";
              request.addEventListener(
                "load",
                (event) => {
                  decodeAudioBufferData(event, song);
                },
                false
              );
              request.send();
            }

            function decodeAudioBufferData(event, song) {
              var request = event.target;

              audioCtx.decodeAudioData(
                request.response,

                function (buffer) {
                  if (!buffer) {
                    console.error(
                      "createAudioBufferSource: error decoding file data"
                    );
                    return;
                  }

                  song["audioBuffer"] = buffer;

                  if (song["id"] === currentSong) {
                    showButton();
                    centerButton();
                  }
                },

                function (error) {
                  console.error(
                    "createAudioBufferSource: decodeAudioData error",
                    error
                  );
                }
              );
            }

            // --------------------------------------------------------------

            function startAudio() {
              if (!playingAudio) {
                initAudio();
              }
            }

            function loadCallback(id) {
              var head = configHeads[id];

              head["itemCounter"] += 1;

              if (head["itemCounter"] >= head["itemsToLoad"]) {
                head["loadingElement"].style.display = "none";

                /*
                if ( currentHead === id ) {

                    startAudio();

                }
                */

                head["loaded"] = true;
              }
            }

            function loadCallback1() {
              loadCallback("head1");
            }

            function loadCallback2() {
              loadCallback("head2");
            }

            function loadCallback3() {
              loadCallback("head3");
            }

            // --------------------------------------------------------------

            function eyes1gate() {
              var head = configHeads["head1"];

              if (
                commonObjects["eyeInnerCurvedGeo"] &&
                commonObjects["eyeInnerGeo"] &&
                commonObjects["eyeOuterGeo"] &&
                head["meshes"]["head"] &&
                !head["meshes"]["leftEye"]
              ) {
                createEyes("head1");
              }
            }

            function eyes2gate() {
              var head = configHeads["head2"];

              if (
                commonObjects["eyeInnerCurvedGeo"] &&
                commonObjects["eyeInnerGeo"] &&
                commonObjects["eyeOuterGeo"] &&
                head["meshes"]["head"] &&
                !head["meshes"]["leftEye"]
              ) {
                createEyes("head2");
              }
            }

            function eyes3gate() {
              var head = configHeads["head3"];

              if (
                commonObjects["eyeInnerCurvedGeo"] &&
                commonObjects["eyeInnerGeo"] &&
                commonObjects["eyeOuterGeo"] &&
                head["meshes"]["head"] &&
                !head["meshes"]["leftEye"]
              ) {
                createEyes("head3");
              }
            }

            function eyeInnerCurvedLoadedCallback(geometry) {
              geometry.computeBoundingBox();
              XG.GeometryUtils.center([geometry]);

              //

              eyes1gate();
              eyes2gate();
              eyes3gate();
            }

            function eyeInnerLoadedCallback(geometry) {
              geometry.computeBoundingBox();
              XG.GeometryUtils.center([geometry]);

              //

              eyes1gate();
              eyes2gate();
              eyes3gate();
            }

            function eyeOuterLoadedCallback(geometry) {
              geometry.computeBoundingBox();
              XG.GeometryUtils.center([geometry]);

              //

              eyes1gate();
              eyes2gate();
              eyes3gate();
            }

            function head1LoadedCallback() {
              eyes1gate();

              var headSong = configHeads["head1"]["song"];

              if (currentSong !== headSong) {
                var song = configSong[headSong];
                song["buttonElement"].style.display = "block";
              }

              if (currentHead === "head1") {
                startAudio();
              }
            }

            function head2LoadedCallback() {
              eyes2gate();

              var headSong = configHeads["head2"]["song"];

              if (currentSong !== headSong) {
                var song = configSong[headSong];
                song["buttonElement"].style.display = "block";
              }

              if (currentHead === "head2") {
                startAudio();
              }
            }

            function head3LoadedCallback() {
              eyes3gate();

              var headSong = configHeads["head3"]["song"];

              if (currentSong !== headSong) {
                var song = configSong[headSong];
                song["buttonElement"].style.display = "block";
              }

              if (currentHead === "head3") {
                startAudio();
              }
            }

            // --------------------------------------------------------------

            function loadTextures(id, callback) {
              var head = configHeads[id];
              var diffuseMap = XG.ImageUtils.loadTexture(
                head["diffuseMap"],
                callback
              );
              var bumpMap = XG.ImageUtils.loadTexture(
                head["bumpMap"],
                callback
              );
              var glossMap = XG.ImageUtils.loadTexture(
                head["glossMap"],
                callback
              );

              diffuseMap.anisotropy = 8;
              bumpMap.anisotropy = 8;
              glossMap.anisotropy = 8;

              head["diffuseTex"] = diffuseMap;
              head["bumpTex"] = bumpMap;
              head["glossTex"] = glossMap;
            }

            // --------------------------------------------------------------

            function createEyes(id) {
              var head = configHeads[id];
              var root = head["root"];
              var meshes = head["meshes"];
              var innerCurvedGeometry = commonObjects["eyeInnerCurvedGeo"];
              var innerGeometry = commonObjects["eyeInnerGeo"];
              var outerGeometry = commonObjects["eyeOuterGeo"];
              var skinMaterial = meshes["head"].materials[0];
              var leftEyePos = head["leftEyePos"];
              var rightEyePos = head["rightEyePos"];
              var irises = head["irises"];
              var eyeScale = head["eyeScale"];
              var eyesInnerRightRot = head["eyesInnerRightRot"];
              var eyesInnerLeftRot = head["eyesInnerLeftRot"];

              // rig

              var leftGyro = new XG.Gyroscope();
              leftGyro.position.set(
                leftEyePos[0],
                leftEyePos[1],
                leftEyePos[2]
              );

              var rightGyro = new XG.Gyroscope();
              rightGyro.position.set(
                rightEyePos[0],
                rightEyePos[1],
                rightEyePos[2]
              );

              root.add(leftGyro);
              root.add(rightGyro);

              // inner eyes

              var eyesInnerPhongMaterial =
                commonObjects["eyesInnerPhongMaterial"];
              var eyesInnerEmissiveMaterial =
                commonObjects["eyesInnerEmissiveMaterial"];
              var eyesInnerMetallicMaterial =
                commonObjects["eyesInnerMetallicMaterial"];
              var eyesOverlayMaterial = commonObjects["eyesOverlayMaterial"];
              var irisMaterials = [];
              var headMaterials = [];
              var overlayMaterials = [];

              for (var i = 0, il = irises.length; i < il; i++) {
                var iris = irises[i];
                var irisType = iris.type;

                var irisBumpMap = commonObjects[iris.bumpMap];
                var irisBumpScale = iris.bumpScale;

                var irisMapSrc = iris.map;
                var altMap = iris.altMap;
                var requires = iris.requires;

                if (requires === "videoTexture" && !useVideoTextures) {
                  irisMapSrc = altMap;
                }

                if (requires === "canvasTexture" && !useCanvasTextures) {
                  irisMapSrc = altMap;
                }

                if (iris.dynamicData && !useShaderTextures) {
                  irisMapSrc = iris.dynamicData.map;
                  iris.dynamicData = {};
                }

                var irisMap = commonObjects[irisMapSrc];

                //

                if (irisType === "emissive") {
                  var irisMaterial = eyesInnerEmissiveMaterial.clone();
                } else if (irisType === "metallic") {
                  var irisMaterial = eyesInnerMetallicMaterial.clone();
                } else if (irisType === "phong") {
                  var irisMaterial = eyesInnerPhongMaterial.clone();
                }

                if (irisType === "emissive" || irisType === "phong") {
                  irisMaterial.map = irisMap;
                }

                if (irisType === "phong") {
                  if (iris.specularMap) {
                    irisMaterial.specularMap = commonObjects[iris.specularMap];
                  } else {
                    irisMaterial.specularMap = commonObjects["blackMap"];
                  }
                }

                if (irisType === "metallic") {
                  irisMaterial.specularMap = irisMap;
                }

                if (irisBumpMap) {
                  irisMaterial.bumpMap = irisBumpMap;

                  if (irisBumpScale !== undefined) {
                    irisMaterial.bumpScale = irisBumpScale;
                  }
                }

                //

                irisMaterial.dynamicData = iris.dynamicData;

                // --------------------------------------------------------------

                var overlayData = iris.overlayData;

                var overlayMaterial = eyesOverlayMaterial.clone();
                overlayMaterial.overlayData = overlayData;

                if (iris.overlay) {
                  var overlayMapSrc = iris.overlay;

                  if (overlayData && overlayData.requires) {
                    if (
                      overlayData.requires === "canvasTexture" &&
                      !useCanvasTextures
                    ) {
                      overlayMapSrc = overlayData.altMap;
                    }

                    if (
                      overlayData.requires === "videoTexture" &&
                      !useVideoTextures
                    ) {
                      overlayMapSrc = overlayData.altMap;
                    }
                  }

                  var overlayMap = commonObjects[overlayMapSrc];

                  overlayMaterial.map = overlayMap;
                  overlayMaterial.isVisible = true;
                } else {
                  overlayMaterial.map = commonObjects["blackMap"];
                  overlayMaterial.overlayData = {};
                  overlayMaterial.isVisible = false;
                }

                // --------------------------------------------------------------

                var matListEntry = {
                  head: skinMaterial,
                  iris: irisMaterial,
                  overlay: overlayMaterial,
                };

                headMaterials[i] = matListEntry;
                irisMaterials[i] = irisMaterial;
                overlayMaterials[i] = overlayMaterial;
              }

              //

              var initMaterialIris = irisMaterials[0];
              var initMaterialOverlay = overlayMaterials[0];

              var irisMap = getMaterialTexture(initMaterialIris);
              var overlayMap = getMaterialTexture(initMaterialOverlay);

              var irisType = getTextureType(irisMap);
              var overlayType = getTextureType(overlayMap);

              head["currentIrisTextureType"] = irisType;
              head["currentOverlayTextureType"] = overlayType;
              head["currentOverlayData"] = initMaterialOverlay.overlayData;
              head["currentDynamicData"] = initMaterialIris.dynamicData;

              if (id === currentHead) {
                if (irisType === "VIDEO") {
                  currentVideoBase = irisMap.properties["videoIndex"];
                }

                if (overlayType === "VIDEO") {
                  currentVideoOverlay = overlayMap.properties["videoIndex"];
                }
              }

              // right

              var eyesInnerRight = new XG.Mesh(
                innerCurvedGeometry,
                initMaterialIris
              );
              eyesInnerRight.castShadow = true;
              eyesInnerRight.receiveShadow = true;

              eyesInnerRight.scale.multiplyScalar(eyeScale);
              eyesInnerRight.rotation.set(
                eyesInnerRightRot[0],
                eyesInnerRightRot[1],
                eyesInnerRightRot[2]
              );

              // left

              var eyesInnerLeft = new XG.Mesh(
                innerCurvedGeometry,
                initMaterialIris
              );
              eyesInnerLeft.castShadow = true;
              eyesInnerLeft.receiveShadow = true;

              eyesInnerLeft.scale.multiplyScalar(eyeScale);
              eyesInnerLeft.rotation.set(
                eyesInnerLeftRot[0],
                eyesInnerLeftRot[1],
                eyesInnerLeftRot[2]
              );

              // eye overlays

              var eyesRightOverlay = new XG.Mesh(
                innerGeometry,
                initMaterialOverlay
              );

              eyesRightOverlay.scale.multiplyScalar(eyeScale);
              eyesRightOverlay.rotation.set(
                eyesInnerRightRot[0],
                eyesInnerRightRot[1],
                eyesInnerRightRot[2]
              );

              var eyesLeftOverlay = new XG.Mesh(
                innerGeometry,
                initMaterialOverlay
              );

              eyesLeftOverlay.scale.multiplyScalar(eyeScale);
              eyesLeftOverlay.rotation.set(
                eyesInnerLeftRot[0],
                eyesInnerLeftRot[1],
                eyesInnerLeftRot[2]
              );

              // eye pupils

              var pupilDebug = false;

              if (pupilDebug) {
                var pupilGeometry = new XG.SphereGeometry(0.0125, 32, 16);
                var pupilMaterial = new XG.EmissiveMaterial({
                  color: 0xff0000,
                });
                var pupilUpMaterial = new XG.EmissiveMaterial({
                  color: 0xffaa00,
                });
                var pupilSideMaterial = new XG.EmissiveMaterial({
                  color: 0x00aaff,
                });
                var lensMaterial = new XG.EmissiveMaterial({ color: 0x0000ff });
                var hitMaterial = new XG.EmissiveMaterial({ color: 0x00ff00 });

                var eyesRightPupil = new XG.Mesh(pupilGeometry, pupilMaterial);
                var eyesLeftPupil = new XG.Mesh(pupilGeometry, pupilMaterial);

                var eyesRightPupilUp = new XG.Mesh(
                  pupilGeometry,
                  pupilUpMaterial
                );
                var eyesLeftPupilUp = new XG.Mesh(
                  pupilGeometry,
                  pupilUpMaterial
                );

                var eyesRightPupilSide = new XG.Mesh(
                  pupilGeometry,
                  pupilSideMaterial
                );
                var eyesLeftPupilSide = new XG.Mesh(
                  pupilGeometry,
                  pupilSideMaterial
                );

                var eyesRightLens = new XG.Mesh(pupilGeometry, lensMaterial);
                var eyesLeftLens = new XG.Mesh(pupilGeometry, lensMaterial);

                var eyesRightHit = new XG.Mesh(pupilGeometry, hitMaterial);
                var eyesLeftHit = new XG.Mesh(pupilGeometry, hitMaterial);

                eyesRightHit.scale.multiplyScalar(eyeScale);
                eyesLeftHit.scale.multiplyScalar(eyeScale);
              } else {
                var eyesRightPupil = new XG.Node();
                var eyesLeftPupil = new XG.Node();

                var eyesRightPupilUp = new XG.Node();
                var eyesLeftPupilUp = new XG.Node();

                var eyesRightPupilSide = new XG.Node();
                var eyesLeftPupilSide = new XG.Node();

                var eyesRightLens = new XG.Node();
                var eyesLeftLens = new XG.Node();

                var eyesRightHit = new XG.Node();
                var eyesLeftHit = new XG.Node();
              }

              //

              var pd = -0.14;

              eyesRightLens.position.z = pd;
              eyesLeftLens.position.z = pd;

              //

              var pd = -0.12;
              var pp = 0.055;

              eyesRightPupil.position.z = pd;
              eyesLeftPupil.position.z = pd;

              //

              eyesRightPupilUp.position.z = pd;
              eyesLeftPupilUp.position.z = pd;

              eyesRightPupilUp.position.y = pp;
              eyesLeftPupilUp.position.y = pp;

              //

              eyesRightPupilSide.position.z = pd;
              eyesLeftPupilSide.position.z = pd;

              eyesRightPupilSide.position.x = pp;
              eyesLeftPupilSide.position.x = pp;

              //

              //eyesRightHit.position.z = pd;
              //eyesLeftHit.position.z = pd;

              //eyesRightHit.position.x = 0.5 * pp;
              //eyesLeftHit.position.x = 0.5 * pp;

              // outer eyes

              var eyesOuterLeft = new XG.Mesh(
                outerGeometry,
                commonObjects["eyesOuterMaterial"]
              );
              eyesOuterLeft.castShadow = true;
              eyesOuterLeft.receiveShadow = useEyeballShadows;

              eyesOuterLeft.scale.multiplyScalar(eyeScale);
              eyesOuterLeft.rotation.copy(eyesInnerLeft.rotation);
              eyesOuterLeft.position.z = 2;

              //

              var eyesOuterRight = new XG.Mesh(
                outerGeometry,
                commonObjects["eyesOuterMaterial"]
              );
              eyesOuterRight.castShadow = true;
              eyesOuterRight.receiveShadow = useEyeballShadows;

              eyesOuterRight.scale.multiplyScalar(eyeScale);
              eyesOuterRight.rotation.copy(eyesInnerRight.rotation);
              eyesOuterRight.position.z = 2;

              //

              if (id !== currentHead) {
                eyesInnerRight.visible = false;
                eyesInnerLeft.visible = false;
                eyesOuterLeft.visible = false;
                eyesOuterRight.visible = false;

                eyesLeftOverlay.visible = false;
                eyesRightOverlay.visible = false;

                eyesLeftPupil.visible = false;
                eyesRightPupil.visible = false;

                eyesLeftPupilUp.visible = false;
                eyesRightPupilUp.visible = false;

                eyesLeftPupilSide.visible = false;
                eyesRightPupilSide.visible = false;

                eyesLeftLens.visible = false;
                eyesRightLens.visible = false;

                //eyesLeftHit.visible = false;
                //eyesRightHit.visible = false;
              }

              rightGyro.add(eyesInnerRight);
              leftGyro.add(eyesInnerLeft);

              leftGyro.add(eyesOuterLeft);
              rightGyro.add(eyesOuterRight);

              leftGyro.add(eyesLeftOverlay);
              rightGyro.add(eyesRightOverlay);

              //

              eyesInnerLeft.add(eyesLeftPupil);
              eyesInnerRight.add(eyesRightPupil);

              eyesInnerLeft.add(eyesLeftPupilUp);
              eyesInnerRight.add(eyesRightPupilUp);

              eyesInnerLeft.add(eyesLeftPupilSide);
              eyesInnerRight.add(eyesRightPupilSide);

              eyesInnerLeft.add(eyesLeftLens);
              eyesInnerRight.add(eyesRightLens);

              //eyesInnerLeft.add( eyesLeftHit );
              //eyesInnerRight.add( eyesRightHit );

              scene.add(eyesLeftHit);
              scene.add(eyesRightHit);

              //

              meshes["leftEye"] = eyesInnerLeft;
              meshes["rightEye"] = eyesInnerRight;

              meshes["leftEyeOverlay"] = eyesLeftOverlay;
              meshes["rightEyeOverlay"] = eyesRightOverlay;

              //

              meshes["leftPupil"] = eyesLeftPupil;
              meshes["rightPupil"] = eyesRightPupil;
              meshes["leftPupilUp"] = eyesLeftPupilUp;
              meshes["rightPupilUp"] = eyesRightPupilUp;
              meshes["leftPupilSide"] = eyesLeftPupilSide;
              meshes["rightPupilSide"] = eyesRightPupilSide;
              meshes["leftLens"] = eyesLeftLens;
              meshes["rightLens"] = eyesRightLens;
              meshes["leftHit"] = eyesLeftHit;
              meshes["rightHit"] = eyesRightHit;

              head["headMaterials"] = headMaterials;
            }

            // --------------------------------------------------------------

            function createScene1(id, geometry, scale) {
              var head = configHeads[id];
              var rootOffset = head["rootOffset"];
              var meshOffset = head["meshOffset"];
              var diffuseTex = head["diffuseTex"];
              var bumpTex = head["bumpTex"];
              var glossTex = head["glossTex"];

              // HEAD

              var skinMaterial = new XG.PhongMaterial({
                color: 0xffffff,
                specular: 0x2b2b2b,
                shininess: 1.05,
                map: diffuseTex,
                glossMap: glossTex,
                bumpMap: bumpTex,
                bumpScale: 4.0,
                wrapAround: true,
              });

              skinMaterial.bumpDetailMap = commonObjects["detailMap"];
              skinMaterial.detailScale = 0.5;
              skinMaterial.detailRepeat.multiplyScalar(64);
              skinMaterial.wrapRGB.set(0.75, 0.5, 0.5).multiplyScalar(0.85);

              //

              var root = new XG.Node();
              root.position.set(rootOffset[0], rootOffset[1], rootOffset[2]);

              var headMesh = new XG.Mesh(geometry, skinMaterial);
              headMesh.position.set(
                meshOffset[0],
                meshOffset[1],
                meshOffset[2]
              );
              headMesh.rotation.y = Math.PI;
              headMesh.scale.multiplyScalar(scale);

              headMesh.castShadow = true;
              headMesh.receiveShadow = true;

              // INNER MOUTH

              var mouthGeometry = new XG.PlaneGeometry(100, 20);
              var mouthMesh = new XG.Mesh(
                mouthGeometry,
                commonObjects["mouthMaterial"]
              );
              mouthMesh.position.y = -60;
              mouthMesh.position.z = 130;

              //

              if (id !== currentHead) {
                headMesh.visible = false;
                mouthMesh.visible = false;
              }

              root.add(headMesh);
              root.add(mouthMesh);
              scene.add(root);

              //

              head["meshes"]["head"] = headMesh;
              head["root"] = root;

              //

              loadCallback1();
              head1LoadedCallback();

              //

              RESIZE_HACK = 0;
              onWindowResize();
            }

            // --------------------------------------------------------------

            function createScene2(id, geometry, scale) {
              var head = configHeads[id];
              var rootOffset = head["rootOffset"];
              var meshOffset = head["meshOffset"];
              var diffuseTex = head["diffuseTex"];
              var bumpTex = head["bumpTex"];
              var glossTex = head["glossTex"];

              // HEAD

              var skinMaterial = new XG.PhongMaterial({
                color: 0xffffff,
                specular: 0x2b2b2b,
                shininess: 0.75,
                map: diffuseTex,
                glossMap: glossTex,
                bumpMap: bumpTex,
                bumpScale: 2,
                wrapAround: true,
              });

              skinMaterial.bumpDetailMap = commonObjects["detailMap"];
              skinMaterial.detailScale = 0.5;
              skinMaterial.detailRepeat.multiplyScalar(64);
              skinMaterial.wrapRGB.set(0.75, 0.5, 0.5).multiplyScalar(0.75);

              //

              var root = new XG.Node();
              root.position.set(rootOffset[0], rootOffset[1], rootOffset[2]);

              var headMesh = new XG.Mesh(geometry, skinMaterial);
              headMesh.position.set(
                meshOffset[0],
                meshOffset[1],
                meshOffset[2]
              );
              headMesh.rotation.y = Math.PI;
              headMesh.scale.multiplyScalar(scale);

              headMesh.castShadow = true;
              headMesh.receiveShadow = true;

              // INNER MOUTH

              var mouthGeometry = new XG.PlaneGeometry(150, 20);
              var mouthMesh = new XG.Mesh(
                mouthGeometry,
                commonObjects["mouthMaterial"]
              );
              mouthMesh.position.y = -60;
              mouthMesh.position.z = 130;

              //

              if (id !== currentHead) {
                headMesh.visible = false;
                mouthMesh.visible = false;
              }

              root.add(headMesh);
              root.add(mouthMesh);
              scene.add(root);

              //

              head["meshes"]["head"] = headMesh;
              head["root"] = root;

              //

              loadCallback2();
              head2LoadedCallback();

              //

              RESIZE_HACK = 0;
              onWindowResize();
            }

            // --------------------------------------------------------------

            function createScene3(id, geometry, scale) {
              var head = configHeads[id];
              var rootOffset = head["rootOffset"];
              var meshOffset = head["meshOffset"];
              var diffuseTex = head["diffuseTex"];
              var bumpTex = head["bumpTex"];
              var glossTex = head["glossTex"];

              // HEAD

              var skinMaterial = new XG.PhongMaterial({
                color: 0xffffff,
                specular: 0x2b2b2b,
                shininess: 0.4,
                map: diffuseTex,
                glossMap: glossTex,
                bumpMap: bumpTex,
                bumpScale: 1.75,
                wrapAround: true,
              });

              skinMaterial.bumpDetailMap = commonObjects["detailMap"];
              skinMaterial.detailScale = 0.5;
              skinMaterial.detailRepeat.multiplyScalar(64);
              skinMaterial.wrapRGB.set(0.75, 0.5, 0.5).multiplyScalar(0.75);

              //

              var root = new XG.Node();
              root.position.set(rootOffset[0], rootOffset[1], rootOffset[2]);

              var headMesh = new XG.Mesh(geometry, skinMaterial);
              headMesh.rotation.y = Math.PI;
              headMesh.position.set(
                meshOffset[0],
                meshOffset[1],
                meshOffset[2]
              );
              headMesh.scale.multiplyScalar(scale);

              headMesh.castShadow = true;
              headMesh.receiveShadow = true;

              // INNER MOUTH

              var mouthGeometry = new XG.PlaneGeometry(135, 40);
              var mouthMesh = new XG.Mesh(
                mouthGeometry,
                commonObjects["mouthMaterial"]
              );
              mouthMesh.position.y = -60;
              mouthMesh.position.z = 130;
              mouthMesh.position.x = 7;

              //

              if (id !== currentHead) {
                headMesh.visible = false;
                mouthMesh.visible = false;
              }

              root.add(headMesh);
              root.add(mouthMesh);
              scene.add(root);

              //

              head["meshes"]["head"] = headMesh;
              head["root"] = root;

              //

              loadCallback3();
              head3LoadedCallback();

              //

              RESIZE_HACK = 0;
              onWindowResize();
            }

            // --------------------------------------------------------------

            function addBackground() {
              var backgroundMatBlack = new XG.PhongMaterial({
                color: 0x000000,
                shininess: 0,
              });
              backgroundMatBlack.side = XG.BackSide;

              var backgroundMatGray = new XG.PhongMaterial({
                color: 0x222222,
                shininess: 0,
              });
              backgroundMatGray.side = XG.BackSide;
              backgroundMatGray.color.setHSV(0.1, 0.1, 0.5);

              var planeGeo = new XG.PlaneGeometry(300, 1000);

              // back pieces

              backA = new XG.Mesh(planeGeo, backgroundMatBlack);
              backA.rotation.x = Math.PI;
              backA.position.z = -350;
              backA.position.x = -(425 - 200);
              scene.add(backA);

              backB = new XG.Mesh(planeGeo, backgroundMatBlack);
              backB.rotation.x = Math.PI;
              backB.position.z = -350;
              backB.position.x = 425 - 200;
              scene.add(backB);

              // back full

              backFull = new XG.Mesh(planeGeo, backgroundMatGray);
              backFull.rotation.x = Math.PI;
              backFull.position.z = -350;
              backFull.position.x = 0;
              backFull.scale.x = 3;
              scene.add(backFull);

              backA.visible = true;
              backB.visible = true;

              backFull.visible = false;
            }

            // --------------------------------------------------------------

            function toggleUltra() {
              if (!isUltra) {
                renderer.setScale(1.0);
                renderer.dofLensBlurScale = 8;
                isUltra = true;
              } else {
                renderer.setScale(SCALE);
                renderer.dofLensBlurScale = 12;
                isUltra = false;
              }

              refreshDebug();
            }

            function toggleColorCorrection() {
              effectColorCorrection.enabled = !effectColorCorrection.enabled;
            }

            function toggleVideo() {
              var video = videos[currentVideoBase];

              if (video.paused) {
                video.play();
              } else {
                video.pause();
              }

              //

              var video = videos[currentVideoOverlay];

              if (video.paused) {
                video.play();
              } else {
                video.pause();
              }
            }

            function getTextureType(texture) {
              return texture.image
                ? texture.image.tagName
                  ? texture.image.tagName.toUpperCase()
                  : "IMG"
                : "SHADER";
            }

            function getMaterialTexture(material) {
              return material.map ? material.map : material.specularMap;
            }

            function toggleEyeMode() {
              var head = configHeads[currentHead];
              head["eyeFollow"] = !head["eyeFollow"];
            }

            function toggleHelp() {
              helpVisible = !helpVisible;

              if (helpVisible) {
                elHelp.style.top = Math.floor((HEIGHT - 300) * 0.5) + "px";
                elHelp.style.display = "block";
              } else {
                elHelp.style.display = "none";
              }
            }

            function refreshDebug() {
              var extraStr = "";

              if (gpuData) {
                extraStr += "<br/><br/>GPU: " + gpuData.fullName;
                extraStr += "<br/>GPU score: " + gpuData.formattedScore;
              } else {
                extraStr += "<br/><br/>GPU: " + "unknown";
              }

              extraStr += "<br/><br/>ultra: " + isUltra;

              elDebug.innerHTML = debugStr + extraStr;
            }

            function toggleDebug() {
              debugVisible = !debugVisible;

              if (debugVisible) {
                elDebug.style.display = "block";
              } else {
                elDebug.style.display = "none";
              }
            }

            function toggleLightFreeze() {
              freezeLights = !freezeLights;
            }

            function handleEscape() {
              if (helpVisible) {
                elHelp.style.display = "none";
                helpVisible = false;
              }
            }

            // --------------------------------------------------------------

            function onWindowResize(event) {
              var isFullscreen = isDocumentInFullScreenMode();

              if (isFullscreen) {
                elPlayer.style.display = "none";
                MARGIN = 0;
              } else {
                elPlayer.style.display = "block";
                MARGIN = 61;
              }

              MARGIN += RESIZE_HACK;

              SIDE_MARGIN = 0;
              if (window.innerWidth > IMG_WIDTH)
                SIDE_MARGIN = (window.innerWidth - IMG_WIDTH) * 0.5;

              WIDTH = window.innerWidth - 2 * SIDE_MARGIN;
              HEIGHT = window.innerHeight - 1 * MARGIN;

              renderer.setSize(WIDTH, HEIGHT);

              camera.aspect = WIDTH / HEIGHT;
              camera.updateProjectionMatrix();

              renderer.domElement.style.left = SIDE_MARGIN + "px";

              elHelp.style.top = Math.floor((HEIGHT - 300) * 0.5) + "px";

              windowHalfX = window.innerWidth / 2;
              windowHalfY = window.innerHeight / 2;

              centerButton();

              var scaledWidth = Math.floor(WIDTH * SCALE_FORWARD);
              var scaledHeight = Math.floor(HEIGHT * SCALE_FORWARD);

              if (!useDeferred) {
                composer.setSize(scaledWidth, scaledHeight);
                effectFXAA.uniforms["resolution"].value.set(
                  1 / scaledWidth,
                  1 / scaledHeight
                );
              }
            }

            // -----------------------------------------------------------------------------------

            function onDocumentMouseMove(event) {
              mouseX = (event.clientX - windowHalfX) * 0.7;
              mouseY = (event.clientY - windowHalfY) * 0.5;
            }

            function onTouchMove(event) {
              event.preventDefault();

              var touches = event.touches;
              var touch = touches[0];

              mouseX = (touch.clientX - windowHalfX) * 0.7 * 2;
              mouseY = (touch.clientY - windowHalfY) * 0.5 * 2;
            }

            // -----------------------------------------------------------------------------------

            function areMaterialsSameType(materialA, materialB) {
              var aE = materialA instanceof XG.EmissiveMaterial;
              var bE = materialB instanceof XG.EmissiveMaterial;

              return (aE && bE) || (!aE && !bE);
            }

            function onClick(event) {
              // cycle through per-head materials list for eyes and head meshes

              var head = configHeads[currentHead];
              var headMaterials = head["headMaterials"];
              var headMaterialsIndex = head["headMaterialsIndex"];
              var meshes = head["meshes"];

              if (!meshes["head"]) return;

              head["headMaterialsIndex"] =
                (headMaterialsIndex + 1) % headMaterials.length;
              var materials = headMaterials[head["headMaterialsIndex"]];
              var headMaterial = materials["head"];
              var eyeMaterial = materials["iris"];
              var oldEyeMaterial = meshes["leftEye"].materials[0];

              meshes["head"].materials[0] = headMaterial;
              meshes["head"].properties.deferredNeedsUpdate = true;

              meshes["leftEye"].materials[0] = eyeMaterial;
              meshes["rightEye"].materials[0] = eyeMaterial;

              meshes["leftEye"].properties.deferredNeedsUpdate = true;
              meshes["rightEye"].properties.deferredNeedsUpdate = true;

              if (areMaterialsSameType(oldEyeMaterial, eyeMaterial)) {
                meshes["leftEye"].properties.deferredInitialized = false;
                meshes["rightEye"].properties.deferredInitialized = false;
              }

              //

              var irisMap = getMaterialTexture(eyeMaterial);
              head["currentIrisTextureType"] = getTextureType(irisMap);

              if (irisMap.properties) {
                var video = videos[currentVideoBase];
                video.pause();

                currentVideoBase = irisMap.properties["videoIndex"];

                video = videos[currentVideoBase];
                video.play();
              }

              //

              var overlayMaterial = materials["overlay"];

              if (overlayMaterial) {
                meshes["leftEyeOverlay"].materials[0] = overlayMaterial;
                meshes["rightEyeOverlay"].materials[0] = overlayMaterial;

                var overlayMap = getMaterialTexture(overlayMaterial);
                head["currentOverlayTextureType"] = getTextureType(overlayMap);

                if (overlayMap.properties) {
                  var video = videos[currentVideoOverlay];
                  video.pause();

                  currentVideoOverlay = overlayMap.properties["videoIndex"];

                  video = videos[currentVideoOverlay];
                  video.play();
                }

                if (overlayMaterial.overlayData) {
                  head["currentOverlayData"] = overlayMaterial.overlayData;

                  if (overlayMaterial.overlayData.intensity !== undefined) {
                    overlayMaterial.intensity =
                      overlayMaterial.overlayData.intensity;
                  }
                }
              }

              //

              head["currentDynamicData"] = eyeMaterial.dynamicData;

              //

              meshes["leftEyeOverlay"].visible = overlayMaterial.isVisible;
              meshes["rightEyeOverlay"].visible = overlayMaterial.isVisible;

              meshes["leftEyeOverlay"].properties.deferredNeedsUpdate = true;
              meshes["rightEyeOverlay"].properties.deferredNeedsUpdate = true;
            }

            // --------------------------------------------------------------

            function onDocumentKeyDown(event) {
              switch (event.keyCode) {
                case 49:
                  /*1*/ setSong("song1");
                  setHead(configSong["song1"]["head"]);
                  break;
                case 50:
                  /*2*/ setSong("song2");
                  setHead(configSong["song2"]["head"]);
                  break;
                case 51:
                  /*3*/ setSong("song3");
                  setHead(configSong["song3"]["head"]);
                  break;

                case 52:
                  /*4*/ setHead("head1");
                  break;
                case 53:
                  /*5*/ setHead("head2");
                  break;
                case 54:
                  /*6*/ setHead("head3");
                  break;

                case 70:
                  /*F*/ toggleLightFreeze();
                  break;
                case 71:
                  /*G*/ toggleFullscreen();
                  break;
                case 85:
                  /*U*/ if (!event.ctrlKey) toggleUltra();
                  break;
                case 67:
                  /*C*/ toggleColorCorrection();
                  break;

                case 80:
                  /*P*/ toggleVideo();
                  break;
                case 77:
                  /*P*/ toggleEyeMode();
                  break;
                case 90:
                  /*Z*/ toggleZoom();
                  break;

                case 72:
                  /*H*/ toggleHelp();
                  break;
                case 68:
                  /*D*/ toggleDebug();
                  break;

                case 27:
                  /*ESC*/ handleEscape();
                  break;
              }
            }

            // --------------------------------------------------------------

            function generateBeatsShifter(id) {
              return function () {
                var song = configSong[id];
                var beats = song["beats"];

                if (
                  song["audioElement"].currentTime >= beats[song["beatIndex"]]
                ) {
                  song["beatIndex"] += 1;
                }

                //console.log( song[ "audioElement" ].currentTime,  song[ "beatIndex" ] );
              };
            }

            function setupVisibilityHander() {
              // Set the name of the hidden property and the change event for visibility

              var hidden, visibilityChange;

              if (typeof document.hidden !== "undefined") {
                // Opera 12.10 and Firefox 18 and later support

                hidden = "hidden";
                visibilityChange = "visibilitychange";
              } else if (typeof document.mozHidden !== "undefined") {
                hidden = "mozHidden";
                visibilityChange = "mozvisibilitychange";
              } else if (typeof document.msHidden !== "undefined") {
                hidden = "msHidden";
                visibilityChange = "msvisibilitychange";
              } else if (typeof document.webkitHidden !== "undefined") {
                hidden = "webkitHidden";
                visibilityChange = "webkitvisibilitychange";
              }

              function handleVisibilityChange() {
                var zSong = configSong[currentSong];

                if (document[hidden]) {
                  //zSong[ "audioElement" ].pause();

                  beatsShifter = generateBeatsShifter(currentSong);
                  zSong["audioElement"].addEventListener(
                    "timeupdate",
                    beatsShifter
                  );
                } else {
                  //zSong[ "audioElement" ].play();

                  if (beatsShifter) {
                    zSong["audioElement"].removeEventListener(
                      "timeupdate",
                      beatsShifter
                    );
                  }
                }
              }

              document.addEventListener(
                visibilityChange,
                handleVisibilityChange,
                false
              );
            }

            // --------------------------------------------------------------

            function computeLightAmount(light, object) {
              var lightAmount =
                (light.intensity * 1) /
                object.position.distanceToSquared(light.position);
              return lightAmount;
            }

            function axisProjection(origin, unitPoint, point) {
              originToPoint.sub(point, origin);
              unitAxisVector.sub(unitPoint, origin);

              var p1 = unitAxisVector.dot(unitAxisVector);
              var p2 = unitAxisVector.dot(originToPoint);

              var t = p2 / p1;

              return t;
            }

            function updateDynamicEyeTexture(head, meshes) {
              if (head["currentDynamicData"]) {
                diffuseUniforms["diffuseSource"].value =
                  commonObjects[head["currentDynamicData"].map];
              } else {
                diffuseUniforms["diffuseSource"].value =
                  commonObjects["blackMap"];
              }

              var causticBrightness =
                head["currentDynamicData"].causticBrightness;

              var leftEye = meshes["leftEye"];
              var rightEye = meshes["rightEye"];

              var leftPupil = meshes["leftPupil"];
              var rightPupil = meshes["rightPupil"];

              var leftPupilUp = meshes["leftPupilUp"];
              var rightPupilUp = meshes["rightPupilUp"];

              var leftPupilSide = meshes["leftPupilSide"];
              var rightPupilSide = meshes["rightPupilSide"];

              var leftLens = meshes["leftLens"];
              var rightLens = meshes["rightLens"];

              var leftHit = meshes["leftHit"];
              var rightHit = meshes["rightHit"];

              //

              scene.updateMatrixWorld();

              leftPupilPosition.copy(leftPupil.matrixWorld.getPosition());
              rightPupilPosition.copy(rightPupil.matrixWorld.getPosition());

              leftPupilUpPosition.copy(leftPupilUp.matrixWorld.getPosition());
              rightPupilUpPosition.copy(rightPupilUp.matrixWorld.getPosition());

              leftPupilSidePosition.copy(
                leftPupilSide.matrixWorld.getPosition()
              );
              rightPupilSidePosition.copy(
                rightPupilSide.matrixWorld.getPosition()
              );

              leftLensPosition.copy(leftLens.matrixWorld.getPosition());
              rightLensPosition.copy(rightLens.matrixWorld.getPosition());

              keyLightPosition.copy(keyLight.matrixWorld.getPosition());

              //

              leftPlane.setFromCoplanarPoints(
                leftPupilPosition,
                leftPupilUpPosition,
                leftPupilSidePosition
              );
              rightPlane.setFromCoplanarPoints(
                rightPupilPosition,
                rightPupilUpPosition,
                rightPupilSidePosition
              );

              leftPlane.intersectLine(
                keyLightPosition,
                leftLensPosition,
                leftHitPosition
              );
              rightPlane.intersectLine(
                keyLightPosition,
                rightLensPosition,
                rightHitPosition
              );

              leftHit.position.copy(leftHitPosition);
              rightHit.position.copy(rightHitPosition);

              //

              //var cy = axisProjection( rightPupilPosition, rightPupilSidePosition, rightHitPosition );
              //var cx = -axisProjection( rightPupilPosition, rightPupilUpPosition, rightHitPosition );

              var cy = axisProjection(
                leftPupilPosition,
                leftPupilSidePosition,
                leftHitPosition
              );
              var cx = -axisProjection(
                leftPupilPosition,
                leftPupilUpPosition,
                leftHitPosition
              );

              cx *= 54;
              cy *= 54;

              //

              var leftEyeLight =
                computeLightAmount(keyLight, leftPupil) +
                computeLightAmount(backLight, leftPupil);
              var rightEyeLight =
                computeLightAmount(keyLight, rightPupil) +
                computeLightAmount(backLight, rightPupil);

              var pupilData = head["currentDynamicData"];
              var lightAmountScale = 25000000;
              var pupilMaxSize = pupilData.pupilMaxSize;
              var pupilSize =
                pupilMaxSize -
                Math.max(leftEyeLight, rightEyeLight) * lightAmountScale;

              var dilationSpeed = 0.025;
              var contractionSpeed = 0.5;
              var pupilDiff = pupilSize - pupilData.pupilSize;
              var pupilChangeSpeed =
                pupilDiff > 0 ? dilationSpeed : contractionSpeed;

              pupilData.pupilSize += pupilChangeSpeed * pupilDiff;

              diffuseUniforms["level"].value = pupilData.pupilSize;
              diffuseUniforms["irisSaturation"].value =
                pupilData.irisSaturation;
              diffuseUniforms["irisBrightness"].value =
                pupilData.irisBrightness;
              diffuseUniforms["scleraBrightness"].value =
                pupilData.scleraBrightness;

              diffuseUniforms["causticCenter"].value.set(cx, cy);
              diffuseUniforms["causticBrightness"].value =
                causticBrightness * keyLight.intensity;

              diffuseComposer.render(0.1);
            }

            // --------------------------------------------------------------

            function updateEyeRig(head, meshes, wasBeat, delta) {
              var leftEye = meshes["leftEye"];
              var rightEye = meshes["rightEye"];
              var leftEyeOverlay = meshes["leftEyeOverlay"];
              var rightEyeOverlay = meshes["rightEyeOverlay"];

              var eyeBehaviorType = head["eyeBehaviorType"];

              if (eyeBehaviorType === 1) {
                if (head["eyeBehaviorCountDown"] <= 0 && wasBeat) {
                  head["eyeFollow"] = !head["eyeFollow"];
                  head["eyeBehaviorCountDown"] = XG.Math.randomFloat(1, 5);
                }

                head["eyeBehaviorCountDown"] -= delta;
              }

              if (head["eyeFollow"]) {
                eyeX = -mouseX * 1.95;
                eyeY = mouseY * 1.95;
              } else {
                eyeX = 0;
                eyeY = 0;
              }

              var d = 0.3;

              eyeTarget.x += d * (eyeX - eyeTarget.x);
              eyeTarget.y += d * (eyeY - eyeTarget.y);
              eyeTarget.z = -2000;

              leftEye.lookAt(eyeTarget);
              rightEye.lookAt(eyeTarget);

              leftEyeOverlay.lookAt(eyeTarget);
              rightEyeOverlay.lookAt(eyeTarget);
            }

            // --------------------------------------------------------------

            function updateVideoTextures(irisType, overlayType) {
              if (irisType === "VIDEO") {
                var video = videos[currentVideoBase];
                var textureVideo = textureVideos[currentVideoBase];

                if (
                  video.readyState === video.HAVE_ENOUGH_DATA &&
                  !video.paused
                ) {
                  textureVideo.needsUpdate = true;
                }
              }

              if (overlayType === "VIDEO") {
                var video = videos[currentVideoOverlay];
                var textureVideo = textureVideos[currentVideoOverlay];

                if (
                  video.readyState === video.HAVE_ENOUGH_DATA &&
                  !video.paused
                ) {
                  textureVideo.needsUpdate = true;
                }
              }
            }

            // --------------------------------------------------------------

            function animate() {
              requestAnimationFrame(animate);

              render();
              if (statsEnabled) stats.update();
            }

            // --------------------------------------------------------------

            function render() {
              var time = Date.now();
              var delta = clock.getDelta();

              targetX = mouseX * 0.001;
              targetY = (mouseY + 100) * 0.001;

              for (var i = 0, il = headList.length; i < il; i++) {
                var head = headList[i];
                var root = head["root"];

                if (root) {
                  root.rotation.y += 0.05 * (targetX - root.rotation.y);
                  root.rotation.x += 0.05 * (targetY - root.rotation.x);
                }
              }

              //

              var head = configHeads[currentHead];
              var meshes = head["meshes"];
              var currentIrisType = head["currentIrisTextureType"];
              var currentOverlayType = head["currentOverlayTextureType"];

              //

              if ((playingAudio || useAudioBuffers) && audioCtx) {
                if (window.AudioContext && analyser && useAudioAnalysis) {
                  analyser.getByteFrequencyData(freqByteData);

                  var length = freqByteData.length;

                  var sumTotal = 0;
                  var sumLow = 0;
                  var sumMid = 0;
                  var sumHigh = 0;

                  var fStart = 170;
                  var fEnd = 240;

                  for (var j = 0; j < length; ++j) {
                    var fVal = freqByteData[j];

                    sumTotal += fVal;

                    if (j < fStart) sumLow += fVal;
                    else if (j > fEnd) sumHigh += fVal;
                    else sumMid += fVal;
                  }

                  var avgLevel = sumTotal / length;

                  var avgLow = sumLow / fStart;
                  var avgMid = sumMid / (fEnd - fStart);
                  var avgHigh = sumHigh / (length - fEnd);
                } else {
                  var avgLevel = 50.0;
                  var avgLow = 50.0;
                  var avgMid = 50.0;
                  var avgHigh = 50.0;
                }

                //

                var song = configSong[currentSong];
                var beats = song["beats"];
                var audio = song["audioElement"];
                var beatIndex = song["beatIndex"];

                var beatsOffset = 0.0;

                var currentTimeBuffer =
                  audioCtx.currentTime -
                  song["audioBufferStartTime"] +
                  song["audioBufferOffsetTime"];

                /*
                if ( useAudioBuffers ) {

                    console.log( audioCtx.currentTime, currentTimeBuffer, beatIndex );

                } else {

                    console.log( audioCtx.currentTime, audio.currentTime, beatIndex );

                }
                */

                var currentTime = useAudioBuffers
                  ? currentTimeBuffer
                  : audio.currentTime;
                var elapsedTime = currentTime + beatsOffset;
                var oldIndex;
                var wasBeat = false;

                if (elapsedTime >= beats[beatIndex]) {
                  song["beatIndex"] += 1;

                  oldIndex = lightIndex;

                  if (freezeLights) {
                    lightIndex = freezeIndex;
                  } else {
                    do {
                      lightIndex = XG.Math.randomInt(0, lightAngles.length - 1);
                    } while (lightIndex == oldIndex);
                  }

                  var d = 1000;
                  var angle = lightAngles[lightIndex] * 5;
                  var x = Math.sin(angle) * d;
                  var z = Math.cos(angle) * d;
                  keyLight.position.x = x;
                  keyLight.position.z = z;

                  keyLight.forwardShadowSide = shadowSides[lightIndex];

                  if (!freezeLights) {
                    keyLight.position.y = 100 + XG.Math.randomInt(-2, 2) * 40;
                  }

                  wasBeat = true;
                }

                // update live canvas

                if (
                  useCanvasTextures &&
                  window.AudioContext &&
                  useAudioAnalysis &&
                  (currentIrisType === "CANVAS" ||
                    currentOverlayType === "CANVAS")
                ) {
                  var clampedAvgLevel = Math.min(avgLevel, 100);
                  updateCanvas(
                    clampedAvgLevel,
                    freqByteData,
                    wasBeat,
                    elapsedTime,
                    song["bpm"],
                    head["currentOverlayData"]
                  );
                }

                // update lights

                var lightVal = XG.Math.clamp((avgLevel / 255) * 2, 0.0, 1.0);

                if (backLight && !freezeLights) {
                  var backLightMultiplier = head["backLightMultiplier"];
                  var backLightBaseline = head["backLightBaseline"];
                  var songMultipler = head["volumeNormalization"][currentSong];

                  backLight.color.setHSV(0.6, 0.25, 1);
                  backLight.intensity =
                    songMultipler *
                    (lightVal * backLightMultiplier + backLightBaseline);

                  backLight.forwardShadowSide = 1;
                }
              }

              if (useVideoTextures) {
                updateVideoTextures(currentIrisType, currentOverlayType);
              }

              if (eyeRigEnabled && head["loaded"]) {
                updateEyeRig(head, meshes, wasBeat, delta);
              }

              if (
                useShaderTextures &&
                currentIrisType === "SHADER" &&
                meshes["leftEye"]
              ) {
                updateDynamicEyeTexture(head, meshes);
              }

              // render the scene

              if (useDeferred) {
                renderer.render(scene, camera);
              } else {
                composer.render();
              }
            }

            //

            init();
            animate();
          }
        </script>

        <script>
          initAudioPlayer();
        </script>
      </i></i
    >
    <div>
      <canvas width="512" height="512" style="display: none"></canvas
      ><canvas
        width="974"
        height="908"
        style="
          width: 974px;
          height: 908px;
          position: absolute;
          top: 0px;
          left: 0px;
        "
      ></canvas>
      <div id="stats" style="width: 80px; opacity: 0.9; cursor: pointer">
        <div
          id="fps"
          style="
            padding: 0px 0px 3px 3px;
            text-align: left;
            background-color: rgb(0, 0, 34);
          "
        >
          <div
            id="fpsText"
            style="
              color: rgb(0, 255, 255);
              font-family: Helvetica, Arial, sans-serif;
              font-size: 9px;
              font-weight: bold;
              line-height: 15px;
            "
          >
            54 FPS (0-61)
          </div>
          <div
            id="fpsGraph"
            style="
              position: relative;
              width: 74px;
              height: 30px;
              background-color: rgb(0, 255, 255);
            "
          >
            <span
              style="
                width: 1px;
                height: 13.8px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.7px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.7px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 15.6px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.7px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 15px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.5px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.8px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.8px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 12.9px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.2px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.8px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.2px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 12.3px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 12.6px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.4px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 15.6px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 16.2px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 15px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.5px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.2px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 12.6px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 12.6px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 15px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.4px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 17.1px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 17.4px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 17.4px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 17.1px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 15.6px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 17.4px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 17.7px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 17.4px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 16.2px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.8px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 12.3px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 15.6px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 12.6px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.5px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 15.9px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 15.3px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.1px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 16.5px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.1px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.1px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.2px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.1px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.7px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.2px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.8px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.5px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.1px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.7px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 30px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.3px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 12.6px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.1px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 15px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.7px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.4px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 15.9px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.4px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.7px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.7px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.4px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 15px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.1px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 28.5px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.1px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.1px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.4px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.4px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 14.1px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 13.8px;
                float: left;
                background-color: rgb(17, 17, 51);
              "
            ></span>
          </div>
        </div>
        <div
          id="ms"
          style="
            padding: 0px 0px 3px 3px;
            text-align: left;
            background-color: rgb(0, 34, 0);
            display: none;
          "
        >
          <div
            id="msText"
            style="
              color: rgb(0, 255, 0);
              font-family: Helvetica, Arial, sans-serif;
              font-size: 9px;
              font-weight: bold;
              line-height: 15px;
            "
          >
            24 MS (2-837243)
          </div>
          <div
            id="msGraph"
            style="
              position: relative;
              width: 74px;
              height: 30px;
              background-color: rgb(0, 255, 0);
            "
          >
            <span
              style="
                width: 1px;
                height: 26.4px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.4px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.9px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.15px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.85px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.15px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.75px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.3px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.15px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.3px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.45px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.45px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.9px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.45px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.15px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.45px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.45px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.75px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.85px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.4px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.15px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.85px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.3px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.45px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.75px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.45px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.45px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.1px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.4px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.75px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.3px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.3px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.85px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.85px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.4px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.15px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.7px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.3px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.45px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.75px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.15px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.15px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.15px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.3px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.45px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.15px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.3px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.15px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.75px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.6px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.9px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27.15px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.4px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.85px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.7px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 27px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span
            ><span
              style="
                width: 1px;
                height: 26.4px;
                float: left;
                background-color: rgb(17, 51, 17);
              "
            ></span>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
